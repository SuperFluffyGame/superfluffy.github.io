import{O as ve,S as H,i as J,s as X,k as y,a as L,l as $,m as I,c as S,h as m,n as g,b as N,G as p,L as R,P as be,f as j,g as z,t as B,d as K,M as oe,Q as ge,K as ce,A as F,R as ke,T as Me,q as k,r as M,u as T,H as fe,e as te,I as we,v as ue,w as _e,x as de,y as he,o as ye,U as $e}from"../../../chunks/index-de395be4.js";import{G as Y,a as G,C as P,s as Ce,r as Ee,b as U,g as le,n as Ie,B as Ne,M as je}from"../../../chunks/navigation-deadbd7e.js";import{c as se}from"../../../chunks/singletons-31601b89.js";const Ge=""+new URL("../../../assets/red_mine-cc7afd62.jpg",import.meta.url).href,Oe=""+new URL("../../../assets/red_flag-cf5f7b44.jpg",import.meta.url).href;function pe(i,{delay:e=0,duration:s=400,easing:l=ve}={}){const t=+getComputedStyle(i).opacity;return{delay:e,duration:s,easing:l,css:u=>`opacity: ${u*t}`}}const me=(i,e)=>{if(i.state!==Y.Playing)return;const s=i.board[e];if(s.state===G.Flagged)return;let l=e%i.width,t=Math.floor(e/i.height);if(s.state=G.Opened,s.type===P.Mine&&i.firstMove&&(Ce(i),s.type=P.Empty,Ee(i)),s.type!==P.Mine&&s.numNeighborMines===0)for(let r=0;r<9;r++){const n=Math.floor(r/3)-1,o=r%3-1,a=l+n,c=t+o;if(a<0||a>=i.width||c<0||c>=i.height||n===0&&o===0)continue;const f=c*i.width+a;i.board[f].state===G.Closed&&me(i,f)}if(s.type===P.Mine){i.state=Y.Lost,i.lostToCell=e;for(let r=0;r<i.width*i.height;r++){let n=i.board[r];n.type===P.Mine&&(n.state=G.Opened)}}let u=!0;for(let r=0;r<i.width*i.height;r++)i.board[r].type!==P.Mine&&i.board[r].state!==G.Opened&&(u=!1);u&&(i.state=Y.Won),i.firstMove=!1},Le=(i,e)=>{let s=i.board[e];s.state===G.Closed?s.state=G.Flagged:s.state===G.Flagged&&(s.state=G.Closed)};function Se(i){let e=i[0].numNeighborMines+"",s;return{c(){s=k(e)},l(l){s=M(l,e)},m(l,t){N(l,s,t)},p(l,t){t&1&&e!==(e=l[0].numNeighborMines+"")&&T(s,e)},d(l){l&&m(s)}}}function Be(i){let e,s;return{c(){e=y("img"),this.h()},l(l){e=$(l,"IMG",{alt:!0,src:!0,class:!0}),this.h()},h(){g(e,"alt","M"),ce(e.src,s=Ge)||g(e,"src",s),g(e,"class","svelte-tjtrt9")},m(l,t){N(l,e,t)},p:F,d(l){l&&m(e)}}}function ie(i){let e,s,l;return{c(){e=y("div"),this.h()},l(t){e=$(t,"DIV",{class:!0}),I(e).forEach(m),this.h()},h(){g(e,"class","cover svelte-tjtrt9")},m(t,u){N(t,e,u),l=!0},i(t){l||(s&&s.end(1),l=!0)},o(t){t&&(s=ge(e,pe,{duration:100})),l=!1},d(t){t&&m(e),t&&s&&s.end()}}}function ne(i){let e,s,l;return{c(){e=y("img"),this.h()},l(t){e=$(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ce(e.src,s=Oe)||g(e,"src",s),g(e,"alt","F"),g(e,"class","flag svelte-tjtrt9")},m(t,u){N(t,e,u)},p:F,i(t){t&&(l||ke(()=>{l=Me(e,pe,{duration:100}),l.start()}))},o:F,d(t){t&&m(e)}}}function Pe(i){let e,s,l,t,u,r;function n(_,h){if(_[0].type===P.Mine)return Be;if(_[0].numNeighborMines!==0)return Se}let o=n(i),a=o&&o(i),c=i[0].state!==G.Opened&&ie(),f=i[0].state===G.Flagged&&ne();return{c(){e=y("div"),a&&a.c(),s=L(),c&&c.c(),l=L(),f&&f.c(),this.h()},l(_){e=$(_,"DIV",{class:!0});var h=I(e);a&&a.l(h),s=S(h),c&&c.l(h),l=S(h),f&&f.l(h),h.forEach(m),this.h()},h(){g(e,"class",t="wrapper "+i[0].state+" svelte-tjtrt9")},m(_,h){N(_,e,h),a&&a.m(e,null),p(e,s),c&&c.m(e,null),p(e,l),f&&f.m(e,null),u||(r=[R(e,"click",i[1]),R(e,"contextmenu",be(i[2]))],u=!0)},p(_,[h]){o===(o=n(_))&&a?a.p(_,h):(a&&a.d(1),a=o&&o(_),a&&(a.c(),a.m(e,s))),_[0].state!==G.Opened?c?h&1&&j(c,1):(c=ie(),c.c(),j(c,1),c.m(e,l)):c&&(z(),B(c,1,1,()=>{c=null}),K()),_[0].state===G.Flagged?f?(f.p(_,h),h&1&&j(f,1)):(f=ne(),f.c(),j(f,1),f.m(e,null)):f&&(f.d(1),f=null),h&1&&t!==(t="wrapper "+_[0].state+" svelte-tjtrt9")&&g(e,"class",t)},i(_){j(c),j(f)},o(_){B(c)},d(_){_&&m(e),a&&a.d(),c&&c.d(),f&&f.d(),u=!1,oe(r)}}}function Te(i,e,s){let{cell:l}=e,{index:t}=e;const u=n=>{n.button===0&&U.update(o=>(me(o,t),o))},r=()=>{U.update(n=>(Le(n,t),n))};return i.$$set=n=>{"cell"in n&&s(0,l=n.cell),"index"in n&&s(3,t=n.index)},[l,u,r,t]}class Ye extends H{constructor(e){super(),J(this,e,Te,Pe,X,{cell:0,index:3})}}function re(i,e,s){const l=i.slice();return l[1]=e[s],l[3]=s,l}function De(i){let e;return{c(){e=k("Loading...")},l(s){e=M(s,"Loading...")},m(s,l){N(s,e,l)},p:F,i:F,o:F,d(s){s&&m(e)}}}function Fe(i){let e,s,l=i[0].board,t=[];for(let r=0;r<l.length;r+=1)t[r]=ae(re(i,l,r));const u=r=>B(t[r],1,1,()=>{t[r]=null});return{c(){for(let r=0;r<t.length;r+=1)t[r].c();e=te()},l(r){for(let n=0;n<t.length;n+=1)t[n].l(r);e=te()},m(r,n){for(let o=0;o<t.length;o+=1)t[o].m(r,n);N(r,e,n),s=!0},p(r,n){if(n&1){l=r[0].board;let o;for(o=0;o<l.length;o+=1){const a=re(r,l,o);t[o]?(t[o].p(a,n),j(t[o],1)):(t[o]=ae(a),t[o].c(),j(t[o],1),t[o].m(e.parentNode,e))}for(z(),o=l.length;o<t.length;o+=1)u(o);K()}},i(r){if(!s){for(let n=0;n<l.length;n+=1)j(t[n]);s=!0}},o(r){t=t.filter(Boolean);for(let n=0;n<t.length;n+=1)B(t[n]);s=!1},d(r){we(t,r),r&&m(e)}}}function ae(i){let e,s;return e=new Ye({props:{cell:i[1],index:i[3]}}),{c(){ue(e.$$.fragment)},l(l){_e(e.$$.fragment,l)},m(l,t){de(e,l,t),s=!0},p(l,t){const u={};t&1&&(u.cell=l[1]),e.$set(u)},i(l){s||(j(e.$$.fragment,l),s=!0)},o(l){B(e.$$.fragment,l),s=!1},d(l){he(e,l)}}}function Ve(i){let e,s,l,t,u;const r=[Fe,De],n=[];function o(a,c){return a[0]?0:1}return s=o(i),l=n[s]=r[s](i),{c(){e=y("div"),l.c(),this.h()},l(a){e=$(a,"DIV",{class:!0,style:!0});var c=I(e);l.l(c),c.forEach(m),this.h()},h(){var a,c,f,_;g(e,"class","board svelte-gq0y7i"),g(e,"style",t=`grid-template-columns: repeat(${(c=(a=i[0])==null?void 0:a.width)!=null?c:2}, 1fr); grid-template-rows: repeat(${(_=(f=i[0])==null?void 0:f.height)!=null?_:2}, 1fr);`)},m(a,c){N(a,e,c),n[s].m(e,null),u=!0},p(a,[c]){var _,h,w,d;let f=s;s=o(a),s===f?n[s].p(a,c):(z(),B(n[f],1,1,()=>{n[f]=null}),K(),l=n[s],l?l.p(a,c):(l=n[s]=r[s](a),l.c()),j(l,1),l.m(e,null)),(!u||c&1&&t!==(t=`grid-template-columns: repeat(${(h=(_=a[0])==null?void 0:_.width)!=null?h:2}, 1fr); grid-template-rows: repeat(${(d=(w=a[0])==null?void 0:w.height)!=null?d:2}, 1fr);`))&&g(e,"style",t)},i(a){u||(j(l),u=!0)},o(a){B(l),u=!1},d(a){a&&m(e),n[s].d()}}}function Ae(i,e,s){let l;return fe(i,U,t=>s(0,l=t)),[l]}class Ue extends H{constructor(e){super(),J(this,e,Ae,Ve,X,{})}}function We(i){let e,s,l,t,u,r=i[1].width+"",n,o,a=i[1].height+"",c,f,_=i[1].numMines+"",h,w;return{c(){e=y("h2"),s=k("You Lost!"),l=L(),t=y("p"),u=k("You lost on a "),n=k(r),o=k("x"),c=k(a),f=k(`\r
                    board with `),h=k(_),w=k(" mines.")},l(d){e=$(d,"H2",{});var v=I(e);s=M(v,"You Lost!"),v.forEach(m),l=S(d),t=$(d,"P",{});var b=I(t);u=M(b,"You lost on a "),n=M(b,r),o=M(b,"x"),c=M(b,a),f=M(b,`\r
                    board with `),h=M(b,_),w=M(b," mines."),b.forEach(m)},m(d,v){N(d,e,v),p(e,s),N(d,l,v),N(d,t,v),p(t,u),p(t,n),p(t,o),p(t,c),p(t,f),p(t,h),p(t,w)},p(d,v){v&2&&r!==(r=d[1].width+"")&&T(n,r),v&2&&a!==(a=d[1].height+"")&&T(c,a),v&2&&_!==(_=d[1].numMines+"")&&T(h,_)},d(d){d&&m(e),d&&m(l),d&&m(t)}}}function qe(i){let e,s,l,t,u,r=i[1].width+"",n,o,a=i[1].height+"",c,f,_=i[1].numMines+"",h,w;return{c(){e=y("h2"),s=k("You Won!"),l=L(),t=y("p"),u=k("Congratulations, you won on a "),n=k(r),o=k("x"),c=k(a),f=k(`\r
                    board with `),h=k(_),w=k(" mines.")},l(d){e=$(d,"H2",{});var v=I(e);s=M(v,"You Won!"),v.forEach(m),l=S(d),t=$(d,"P",{});var b=I(t);u=M(b,"Congratulations, you won on a "),n=M(b,r),o=M(b,"x"),c=M(b,a),f=M(b,`\r
                    board with `),h=M(b,_),w=M(b," mines."),b.forEach(m)},m(d,v){N(d,e,v),p(e,s),N(d,l,v),N(d,t,v),p(t,u),p(t,n),p(t,o),p(t,c),p(t,f),p(t,h),p(t,w)},p(d,v){v&2&&r!==(r=d[1].width+"")&&T(n,r),v&2&&a!==(a=d[1].height+"")&&T(c,a),v&2&&_!==(_=d[1].numMines+"")&&T(h,_)},d(d){d&&m(e),d&&m(l),d&&m(t)}}}function Re(i){let e,s,l,t,u,r,n,o,a,c,f,_,h,w,d,v,b,Q;u=new Ue({});function Z(E,O){var V,A;if(((V=E[1])==null?void 0:V.state)===Y.Won)return qe;if(((A=E[1])==null?void 0:A.state)===Y.Lost)return We}let D=Z(i),C=D&&D(i);return{c(){e=y("main"),s=y("section"),l=y("div"),t=L(),ue(u.$$.fragment),r=L(),n=y("dialog"),o=y("div"),C&&C.c(),a=L(),c=y("div"),f=y("button"),_=k("Back to Menu"),h=L(),w=y("button"),d=k("New Game"),this.h()},l(E){e=$(E,"MAIN",{class:!0});var O=I(e);s=$(O,"SECTION",{class:!0});var V=I(s);l=$(V,"DIV",{class:!0}),I(l).forEach(m),V.forEach(m),t=S(O),_e(u.$$.fragment,O),r=S(O),n=$(O,"DIALOG",{class:!0});var A=I(n);o=$(A,"DIV",{class:!0});var W=I(o);C&&C.l(W),a=S(W),c=$(W,"DIV",{class:!0});var q=I(c);f=$(q,"BUTTON",{class:!0});var x=I(f);_=M(x,"Back to Menu"),x.forEach(m),h=S(q),w=$(q,"BUTTON",{class:!0});var ee=I(w);d=M(ee,"New Game"),ee.forEach(m),q.forEach(m),W.forEach(m),A.forEach(m),O.forEach(m),this.h()},h(){g(l,"class","click-type-container"),g(s,"class","save-game-sidebar"),g(f,"class","goto-menu"),g(w,"class","new-game"),g(c,"class","buttons-container-vertical svelte-c2sjrf"),g(o,"class","modal-main svelte-c2sjrf"),g(n,"class","aftergame-modal svelte-c2sjrf"),g(e,"class","wrapper svelte-c2sjrf")},m(E,O){N(E,e,O),p(e,s),p(s,l),p(e,t),de(u,e,null),p(e,r),p(e,n),p(n,o),C&&C.m(o,null),p(o,a),p(o,c),p(c,f),p(f,_),p(c,h),p(c,w),p(w,d),i[4](n),v=!0,b||(Q=[R(f,"click",i[3]),R(w,"click",i[2])],b=!0)},p(E,[O]){D===(D=Z(E))&&C?C.p(E,O):(C&&C.d(1),C=D&&D(E),C&&(C.c(),C.m(o,a)))},i(E){v||(j(u.$$.fragment,E),v=!0)},o(E){B(u.$$.fragment,E),v=!1},d(E){E&&m(e),he(u),C&&C.d(),i[4](null),b=!1,oe(Q)}}}function He(i,e,s){let l;fe(i,U,o=>s(1,l=o));let t;U.subscribe(o=>{var a;(o==null?void 0:o.state)!==Y.Playing&&((a=t==null?void 0:t.showModal)==null||a.call(t))}),ye(()=>{l===null?le(`${se}`):l.state!==Y.Playing&&t.showModal()});const u=()=>{Ie(Ne[l.width]),t.close()},r=()=>{localStorage.removeItem(je),le(`${se}`),t.close()};function n(o){$e[o?"unshift":"push"](()=>{t=o,s(0,t)})}return[t,l,u,r,n]}class Ke extends H{constructor(e){super(),J(this,e,He,Re,X,{})}}export{Ke as default};
