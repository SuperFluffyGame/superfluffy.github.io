import{O as ke,S as Q,i as Z,s as x,k as C,a as S,l as E,m as N,c as D,h as m,n as g,b as j,G as p,J as H,P as we,f as I,g as J,t as L,d as X,K as me,Q as Me,I as be,A,R as ye,T as $e,q as w,r as M,u as V,H as K,e as oe,L as Ce,v as ee,w as te,x as le,y as se,o as Ee,U as Ie}from"../../../chunks/index-fdc6cb39.js";import{G as Y,C as B,a as T,s as Ge,r as Ne,b as W,M as je,c as Oe,g as ce,d as Be,n as Le,B as Se,e as De}from"../../../chunks/MiniBoard-b021ea33.js";import{c as fe}from"../../../chunks/singletons-ccdced21.js";const Pe=""+new URL("../../../assets/red_mine-cc7afd62.jpg",import.meta.url).href,Te=""+new URL("../../../assets/red_flag-cf5f7b44.jpg",import.meta.url).href;function ve(i,{delay:e=0,duration:s=400,easing:l=ke}={}){const t=+getComputedStyle(i).opacity;return{delay:e,duration:s,easing:l,css:o=>`opacity: ${o*t}`}}const ge=(i,e)=>{if(i.state!==Y.Playing)return;const s=i.board[e];if(s.state===B.Flagged)return;let l=e%i.width,t=Math.floor(e/i.height);if(s.state=B.Opened,s.type===T.Mine&&i.firstMove&&(Ge(i),s.type=T.Empty,Ne(i)),s.type!==T.Mine&&s.numNeighborMines===0)for(let a=0;a<9;a++){const r=Math.floor(a/3)-1,f=a%3-1,n=l+r,c=t+f;if(n<0||n>=i.width||c<0||c>=i.height||r===0&&f===0)continue;const u=c*i.width+n;i.board[u].state===B.Closed&&ge(i,u)}if(s.type===T.Mine){i.state=Y.Lost,i.lostToCell=e;for(let a=0;a<i.width*i.height;a++){let r=i.board[a];r.type===T.Mine&&(r.state=B.Opened)}}let o=!0;for(let a=0;a<i.width*i.height;a++)i.board[a].type!==T.Mine&&i.board[a].state!==B.Opened&&(o=!1);o&&(i.state=Y.Won),i.firstMove=!1},Ve=(i,e)=>{let s=i.board[e];s.state===B.Closed?s.state=B.Flagged:s.state===B.Flagged&&(s.state=B.Closed)};function Ye(i){let e=i[0].numNeighborMines+"",s;return{c(){s=w(e)},l(l){s=M(l,e)},m(l,t){j(l,s,t)},p(l,t){t&1&&e!==(e=l[0].numNeighborMines+"")&&V(s,e)},d(l){l&&m(s)}}}function Fe(i){let e,s;return{c(){e=C("img"),this.h()},l(l){e=E(l,"IMG",{alt:!0,src:!0,class:!0}),this.h()},h(){g(e,"alt","M"),be(e.src,s=Pe)||g(e,"src",s),g(e,"class","svelte-tjtrt9")},m(l,t){j(l,e,t)},p:A,d(l){l&&m(e)}}}function ue(i){let e,s,l;return{c(){e=C("div"),this.h()},l(t){e=E(t,"DIV",{class:!0}),N(e).forEach(m),this.h()},h(){g(e,"class","cover svelte-tjtrt9")},m(t,o){j(t,e,o),l=!0},i(t){l||(s&&s.end(1),l=!0)},o(t){t&&(s=Me(e,ve,{duration:100})),l=!1},d(t){t&&m(e),t&&s&&s.end()}}}function de(i){let e,s,l;return{c(){e=C("img"),this.h()},l(t){e=E(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){be(e.src,s=Te)||g(e,"src",s),g(e,"alt","F"),g(e,"class","flag svelte-tjtrt9")},m(t,o){j(t,e,o)},p:A,i(t){t&&(l||ye(()=>{l=$e(e,ve,{duration:100}),l.start()}))},o:A,d(t){t&&m(e)}}}function Ae(i){let e,s,l,t,o,a;function r(d,h){if(d[0].type===T.Mine)return Fe;if(d[0].numNeighborMines!==0)return Ye}let f=r(i),n=f&&f(i),c=i[0].state!==B.Opened&&ue(),u=i[0].state===B.Flagged&&de();return{c(){e=C("div"),n&&n.c(),s=S(),c&&c.c(),l=S(),u&&u.c(),this.h()},l(d){e=E(d,"DIV",{class:!0});var h=N(e);n&&n.l(h),s=D(h),c&&c.l(h),l=D(h),u&&u.l(h),h.forEach(m),this.h()},h(){g(e,"class",t="wrapper "+i[0].state+" svelte-tjtrt9")},m(d,h){j(d,e,h),n&&n.m(e,null),p(e,s),c&&c.m(e,null),p(e,l),u&&u.m(e,null),o||(a=[H(e,"click",i[1]),H(e,"contextmenu",we(i[2]))],o=!0)},p(d,[h]){f===(f=r(d))&&n?n.p(d,h):(n&&n.d(1),n=f&&f(d),n&&(n.c(),n.m(e,s))),d[0].state!==B.Opened?c?h&1&&I(c,1):(c=ue(),c.c(),I(c,1),c.m(e,l)):c&&(J(),L(c,1,1,()=>{c=null}),X()),d[0].state===B.Flagged?u?(u.p(d,h),h&1&&I(u,1)):(u=de(),u.c(),I(u,1),u.m(e,null)):u&&(u.d(1),u=null),h&1&&t!==(t="wrapper "+d[0].state+" svelte-tjtrt9")&&g(e,"class",t)},i(d){I(c),I(u)},o(d){L(c)},d(d){d&&m(e),n&&n.d(),c&&c.d(),u&&u.d(),o=!1,me(a)}}}function Ue(i,e,s){let{cell:l}=e,{index:t}=e;const o=r=>{r.button===0&&W.update(f=>(ge(f,t),f))},a=()=>{W.update(r=>(Ve(r,t),r))};return i.$$set=r=>{"cell"in r&&s(0,l=r.cell),"index"in r&&s(3,t=r.index)},[l,o,a,t]}class We extends Q{constructor(e){super(),Z(this,e,Ue,Ae,x,{cell:0,index:3})}}function _e(i,e,s){const l=i.slice();return l[1]=e[s],l[3]=s,l}function qe(i){let e;return{c(){e=w("Loading...")},l(s){e=M(s,"Loading...")},m(s,l){j(s,e,l)},p:A,i:A,o:A,d(s){s&&m(e)}}}function Re(i){let e,s,l=i[0].board,t=[];for(let a=0;a<l.length;a+=1)t[a]=he(_e(i,l,a));const o=a=>L(t[a],1,1,()=>{t[a]=null});return{c(){for(let a=0;a<t.length;a+=1)t[a].c();e=oe()},l(a){for(let r=0;r<t.length;r+=1)t[r].l(a);e=oe()},m(a,r){for(let f=0;f<t.length;f+=1)t[f].m(a,r);j(a,e,r),s=!0},p(a,r){if(r&1){l=a[0].board;let f;for(f=0;f<l.length;f+=1){const n=_e(a,l,f);t[f]?(t[f].p(n,r),I(t[f],1)):(t[f]=he(n),t[f].c(),I(t[f],1),t[f].m(e.parentNode,e))}for(J(),f=l.length;f<t.length;f+=1)o(f);X()}},i(a){if(!s){for(let r=0;r<l.length;r+=1)I(t[r]);s=!0}},o(a){t=t.filter(Boolean);for(let r=0;r<t.length;r+=1)L(t[r]);s=!1},d(a){Ce(t,a),a&&m(e)}}}function he(i){let e,s;return e=new We({props:{cell:i[1],index:i[3]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),s=!0},p(l,t){const o={};t&1&&(o.cell=l[1]),e.$set(o)},i(l){s||(I(e.$$.fragment,l),s=!0)},o(l){L(e.$$.fragment,l),s=!1},d(l){se(e,l)}}}function He(i){let e,s,l,t,o;const a=[Re,qe],r=[];function f(n,c){return n[0]?0:1}return s=f(i),l=r[s]=a[s](i),{c(){e=C("div"),l.c(),this.h()},l(n){e=E(n,"DIV",{class:!0,style:!0});var c=N(e);l.l(c),c.forEach(m),this.h()},h(){var n,c,u,d;g(e,"class","board svelte-gq0y7i"),g(e,"style",t=`grid-template-columns: repeat(${(c=(n=i[0])==null?void 0:n.width)!=null?c:2}, 1fr); grid-template-rows: repeat(${(d=(u=i[0])==null?void 0:u.height)!=null?d:2}, 1fr);`)},m(n,c){j(n,e,c),r[s].m(e,null),o=!0},p(n,[c]){var d,h,$,_;let u=s;s=f(n),s===u?r[s].p(n,c):(J(),L(r[u],1,1,()=>{r[u]=null}),X(),l=r[s],l?l.p(n,c):(l=r[s]=a[s](n),l.c()),I(l,1),l.m(e,null)),(!o||c&1&&t!==(t=`grid-template-columns: repeat(${(h=(d=n[0])==null?void 0:d.width)!=null?h:2}, 1fr); grid-template-rows: repeat(${(_=($=n[0])==null?void 0:$.height)!=null?_:2}, 1fr);`))&&g(e,"style",t)},i(n){o||(I(l),o=!0)},o(n){L(l),o=!1},d(n){n&&m(e),r[s].d()}}}function Je(i,e,s){let l;return K(i,W,t=>s(0,l=t)),[l]}class Xe extends Q{constructor(e){super(),Z(this,e,Je,He,x,{})}}function ze(i){let e,s,l,t,o,a=i[1].width+"",r,f,n=i[1].height+"",c,u,d=i[1].numMines+"",h,$;return{c(){e=C("h2"),s=w("You Lost!"),l=S(),t=C("p"),o=w("You lost on a "),r=w(a),f=w("x"),c=w(n),u=w(`\r
                    board with `),h=w(d),$=w(" mines.")},l(_){e=E(_,"H2",{});var b=N(e);s=M(b,"You Lost!"),b.forEach(m),l=D(_),t=E(_,"P",{});var v=N(t);o=M(v,"You lost on a "),r=M(v,a),f=M(v,"x"),c=M(v,n),u=M(v,`\r
                    board with `),h=M(v,d),$=M(v," mines."),v.forEach(m)},m(_,b){j(_,e,b),p(e,s),j(_,l,b),j(_,t,b),p(t,o),p(t,r),p(t,f),p(t,c),p(t,u),p(t,h),p(t,$)},p(_,b){b&2&&a!==(a=_[1].width+"")&&V(r,a),b&2&&n!==(n=_[1].height+"")&&V(c,n),b&2&&d!==(d=_[1].numMines+"")&&V(h,d)},d(_){_&&m(e),_&&m(l),_&&m(t)}}}function Ke(i){let e,s,l,t,o,a=i[1].width+"",r,f,n=i[1].height+"",c,u,d=i[1].numMines+"",h,$;return{c(){e=C("h2"),s=w("You Won!"),l=S(),t=C("p"),o=w("Congratulations, you won on a "),r=w(a),f=w("x"),c=w(n),u=w(`\r
                    board with `),h=w(d),$=w(" mines.")},l(_){e=E(_,"H2",{});var b=N(e);s=M(b,"You Won!"),b.forEach(m),l=D(_),t=E(_,"P",{});var v=N(t);o=M(v,"Congratulations, you won on a "),r=M(v,a),f=M(v,"x"),c=M(v,n),u=M(v,`\r
                    board with `),h=M(v,d),$=M(v," mines."),v.forEach(m)},m(_,b){j(_,e,b),p(e,s),j(_,l,b),j(_,t,b),p(t,o),p(t,r),p(t,f),p(t,c),p(t,u),p(t,h),p(t,$)},p(_,b){b&2&&a!==(a=_[1].width+"")&&V(r,a),b&2&&n!==(n=_[1].height+"")&&V(c,n),b&2&&d!==(d=_[1].numMines+"")&&V(h,d)},d(_){_&&m(e),_&&m(l),_&&m(t)}}}function pe(i){let e,s,l;return s=new je({props:{game:i[1],showMines:!0}}),{c(){e=C("div"),ee(s.$$.fragment),this.h()},l(t){e=E(t,"DIV",{class:!0});var o=N(e);te(s.$$.fragment,o),o.forEach(m),this.h()},h(){g(e,"class","mini-board svelte-c2sjrf")},m(t,o){j(t,e,o),le(s,e,null),l=!0},p(t,o){const a={};o&2&&(a.game=t[1]),s.$set(a)},i(t){l||(I(s.$$.fragment,t),l=!0)},o(t){L(s.$$.fragment,t),l=!1},d(t){t&&m(e),se(s)}}}function Qe(i){let e,s,l,t,o,a,r,f,n,c,u,d,h,$,_,b,v,z,ie;o=new Xe({});function ne(y,O){var U,P;if(((U=y[1])==null?void 0:U.state)===Y.Won)return Ke;if(((P=y[1])==null?void 0:P.state)===Y.Lost)return ze}let F=ne(i),G=F&&F(i),k=i[1]&&pe(i);return{c(){e=C("main"),s=C("section"),l=C("div"),t=S(),ee(o.$$.fragment),a=S(),r=C("dialog"),f=C("div"),G&&G.c(),n=S(),c=C("div"),u=C("button"),d=w("Back to Menu"),h=S(),$=C("button"),_=w("New Game"),b=S(),k&&k.c(),this.h()},l(y){e=E(y,"MAIN",{class:!0});var O=N(e);s=E(O,"SECTION",{class:!0});var U=N(s);l=E(U,"DIV",{class:!0}),N(l).forEach(m),U.forEach(m),t=D(O),te(o.$$.fragment,O),a=D(O),r=E(O,"DIALOG",{class:!0});var P=N(r);f=E(P,"DIV",{class:!0});var q=N(f);G&&G.l(q),n=D(q),c=E(q,"DIV",{class:!0});var R=N(c);u=E(R,"BUTTON",{class:!0});var re=N(u);d=M(re,"Back to Menu"),re.forEach(m),h=D(R),$=E(R,"BUTTON",{class:!0});var ae=N($);_=M(ae,"New Game"),ae.forEach(m),R.forEach(m),q.forEach(m),b=D(P),k&&k.l(P),P.forEach(m),O.forEach(m),this.h()},h(){g(l,"class","click-type-container"),g(s,"class","save-game-sidebar"),g(u,"class","goto-menu"),g($,"class","new-game"),g(c,"class","buttons-container-vertical svelte-c2sjrf"),g(f,"class","modal-main svelte-c2sjrf"),g(r,"class","aftergame-modal svelte-c2sjrf"),g(e,"class","wrapper svelte-c2sjrf")},m(y,O){j(y,e,O),p(e,s),p(s,l),p(e,t),le(o,e,null),p(e,a),p(e,r),p(r,f),G&&G.m(f,null),p(f,n),p(f,c),p(c,u),p(u,d),p(c,h),p(c,$),p($,_),p(r,b),k&&k.m(r,null),i[4](r),v=!0,z||(ie=[H(u,"click",i[3]),H($,"click",i[2])],z=!0)},p(y,[O]){F===(F=ne(y))&&G?G.p(y,O):(G&&G.d(1),G=F&&F(y),G&&(G.c(),G.m(f,n))),y[1]?k?(k.p(y,O),O&2&&I(k,1)):(k=pe(y),k.c(),I(k,1),k.m(r,null)):k&&(J(),L(k,1,1,()=>{k=null}),X())},i(y){v||(I(o.$$.fragment,y),I(k),v=!0)},o(y){L(o.$$.fragment,y),L(k),v=!1},d(y){y&&m(e),se(o),G&&G.d(),k&&k.d(),i[4](null),z=!1,me(ie)}}}function Ze(i,e,s){let l,t;K(i,W,n=>s(1,l=n)),K(i,Oe,n=>s(5,t=n));let o;W.subscribe(n=>{var c;(n==null?void 0:n.state)!==Y.Playing&&((c=o==null?void 0:o.showModal)==null||c.call(o))}),Ee(()=>{l===null?ce(`${fe}`):l.state!==Y.Playing&&o.showModal()});const a=()=>{Be(t),Le(Se[l.width]),o.close()},r=()=>{localStorage.removeItem(De),ce(`${fe}`),o.close()};function f(n){Ie[n?"unshift":"push"](()=>{o=n,s(0,o)})}return[o,l,a,r,f]}class lt extends Q{constructor(e){super(),Z(this,e,Ze,Qe,x,{})}}export{lt as default};
