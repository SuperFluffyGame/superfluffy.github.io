import{S as fe,i as ce,s as ue,k as $,a as B,l as I,m as C,c as F,h as b,n as w,p as ne,b as P,G as p,K as ie,a0 as Ve,f as z,g as J,t as L,d as Q,a1 as Oe,a2 as Be,L as De,A,U as Fe,V as we,q as M,r as y,u as T,a3 as We,v as Z,w as x,x as ee,y as te,W as de,H as Me,o as Te,$ as ye,a4 as Ue,X as Xe,Y as je}from"../../../chunks/index-445e7c1b.js";import{G as W,e as O,s as ae,f as j,h as qe,r as He,i as oe,j as R,S as Ke,t as $e,C as Re,c as Ae,g as Ie,l as Je,n as Qe,a as Ze,M as xe,d as Ce}from"../../../chunks/MiniBoard-c6e3960b.js";import{c as Ee}from"../../../chunks/singletons-82a445e4.js";const et=""+new URL("../../../assets/red_mine-cc7afd62.jpg",import.meta.url).href,tt=""+new URL("../../../assets/red_flag-cf5f7b44.jpg",import.meta.url).href,Ne=(n,e)=>{var c;if(n.state!==W.Playing)return;const s=n.board[e];if(s.state===O.Flagged)return;ae.update(i=>i&&(i.cellsOpened+=1,i));let t=e%n.width,l=Math.floor(e/n.height);if(s.state=O.Opened,n.firstMove){const i=[];for(let a=0;a<9;a++){const d=a%3-1,h=Math.floor(a/3)-1,o=(l+h)*n.width+(t+d);i.push(o)}for(let a=0;a<9;a++){const d=a%3-1,h=Math.floor(a/3)-1,o=(l+h)*n.width+(t+d),f=n.board[o];(f==null?void 0:f.type)===j.Mine&&(f.type=j.Empty,qe(n,i))}He(n)}if(n.firstMove=!1,s.type===j.Empty&&s.numNeighborMines===0)for(let i=0;i<9;i++){const a=i%3-1,d=Math.floor(i/3)-1,h=t+a,o=l+d;if(h<0||h>=n.width||o<0||o>=n.height||a===0&&d===0)continue;const f=o*n.width+h;((c=n.board)==null?void 0:c[f].state)===O.Closed&&Ne(n,f)}if(s.type===j.Mine){ae.update(i=>i&&(i.gamesLost+=1,i)),n.state=W.Lost,n.lostToCell=e;for(let i=0;i<n.width*n.height;i++){let a=n.board[i];a.type===j.Mine&&(a.state=O.Opened)}}let r=!0;for(let i=0;i<n.width*n.height;i++)n.board[i].type!==j.Mine&&n.board[i].state!==O.Opened&&(r=!1);r&&(ae.update(i=>i&&(i.gamesWon+=1,i)),n.state=W.Won)},lt=(n,e)=>{if(n.state!==W.Playing)return;let s=n.board[e];s.state===O.Closed?s.state=O.Flagged:s.state===O.Flagged&&(s.state=O.Closed)};function st(n){let e=n[0].numNeighborMines+"",s;return{c(){s=M(e)},l(t){s=y(t,e)},m(t,l){P(t,s,l)},p(t,l){l&1&&e!==(e=t[0].numNeighborMines+"")&&T(s,e)},d(t){t&&b(s)}}}function nt(n){let e,s;return{c(){e=$("img"),this.h()},l(t){e=I(t,"IMG",{alt:!0,src:!0,class:!0}),this.h()},h(){w(e,"alt","M"),De(e.src,s=et)||w(e,"src",s),w(e,"class","svelte-155azrr")},m(t,l){P(t,e,l)},p:A,d(t){t&&b(e)}}}function ze(n){let e,s,t;return{c(){e=$("div"),this.h()},l(l){e=I(l,"DIV",{class:!0}),C(e).forEach(b),this.h()},h(){w(e,"class","cover svelte-155azrr")},m(l,r){P(l,e,r),t=!0},i(l){t||(s&&s.end(1),t=!0)},o(l){l&&(s=Be(e,oe,{duration:100})),t=!1},d(l){l&&b(e),l&&s&&s.end()}}}function Ge(n){let e,s,t,l;return{c(){e=$("img"),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){De(e.src,s=tt)||w(e,"src",s),w(e,"alt","F"),w(e,"class","flag svelte-155azrr")},m(r,c){P(r,e,c),l=!0},p:A,i(r){l||(r&&Fe(()=>{t||(t=we(e,oe,{duration:100},!0)),t.run(1)}),l=!0)},o(r){r&&(t||(t=we(e,oe,{duration:100},!1)),t.run(0)),l=!1},d(r){r&&b(e),r&&t&&t.end()}}}function it(n){let e,s,t,l,r=`${n[1]}px`,c,i;function a(_,g){if(_[0].type===j.Mine)return nt;if(_[0].numNeighborMines!==0)return st}let d=a(n),h=d&&d(n),o=n[0].state!==O.Opened&&ze(),f=n[0].state===O.Flagged&&Ge();return{c(){e=$("div"),h&&h.c(),s=B(),o&&o.c(),t=B(),f&&f.c(),this.h()},l(_){e=I(_,"DIV",{class:!0});var g=C(e);h&&h.l(g),s=F(g),o&&o.l(g),t=F(g),f&&f.l(g),g.forEach(b),this.h()},h(){w(e,"class",l="wrapper "+n[0].state+" svelte-155azrr"),ne(e,"font-size",r,!1)},m(_,g){P(_,e,g),h&&h.m(e,null),p(e,s),o&&o.m(e,null),p(e,t),f&&f.m(e,null),c||(i=[ie(e,"click",n[2]),ie(e,"contextmenu",Ve(n[3]))],c=!0)},p(_,[g]){d===(d=a(_))&&h?h.p(_,g):(h&&h.d(1),h=d&&d(_),h&&(h.c(),h.m(e,s))),_[0].state!==O.Opened?o?g&1&&z(o,1):(o=ze(),o.c(),z(o,1),o.m(e,t)):o&&(J(),L(o,1,1,()=>{o=null}),Q()),_[0].state===O.Flagged?f?(f.p(_,g),g&1&&z(f,1)):(f=Ge(),f.c(),z(f,1),f.m(e,null)):f&&(J(),L(f,1,1,()=>{f=null}),Q()),g&1&&l!==(l="wrapper "+_[0].state+" svelte-155azrr")&&w(e,"class",l),g&2&&r!==(r=`${_[1]}px`)&&ne(e,"font-size",r,!1)},i(_){z(o),z(f)},o(_){L(o),L(f)},d(_){_&&b(e),h&&h.d(),o&&o.d(),f&&f.d(),c=!1,Oe(i)}}}function rt(n,e,s){let{cell:t}=e,{index:l}=e;const r=a=>{a.button===0&&R.update(d=>(Ne(d,l),d))},c=()=>{R.update(a=>(lt(a,l),a))};let{fontSize:i}=e;return n.$$set=a=>{"cell"in a&&s(0,t=a.cell),"index"in a&&s(4,l=a.index),"fontSize"in a&&s(1,i=a.fontSize)},[t,i,r,c,l]}class at extends fe{constructor(e){super(),ce(this,e,rt,it,ue,{cell:0,index:4,fontSize:1})}}function Pe(n,e,s){const t=n.slice();return t[5]=e[s],t[7]=s,t}function Se(n){let e,s;return e=new at({props:{cell:n[5],index:n[7],fontSize:n[2]}}),{c(){Z(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,l){ee(e,t,l),s=!0},p(t,l){const r={};l&1&&(r.cell=t[5]),l&4&&(r.fontSize=t[2]),e.$set(r)},i(t){s||(z(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){te(e,t)}}}function ot(n){let e,s,t,l=n[0].board,r=[];for(let i=0;i<l.length;i+=1)r[i]=Se(Pe(n,l,i));const c=i=>L(r[i],1,1,()=>{r[i]=null});return{c(){e=$("div");for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0,style:!0});var a=C(e);for(let d=0;d<r.length;d+=1)r[d].l(a);a.forEach(b),this.h()},h(){var i,a;w(e,"class","board svelte-h57i0c"),w(e,"style",s=`grid-template-columns: repeat(${(i=n[0].width)!=null?i:2}, 1fr); grid-template-rows: repeat(${(a=n[0].height)!=null?a:2}, 1fr);`)},m(i,a){P(i,e,a);for(let d=0;d<r.length;d+=1)r[d].m(e,null);n[3](e),t=!0},p(i,[a]){var d,h;if(a&5){l=i[0].board;let o;for(o=0;o<l.length;o+=1){const f=Pe(i,l,o);r[o]?(r[o].p(f,a),z(r[o],1)):(r[o]=Se(f),r[o].c(),z(r[o],1),r[o].m(e,null))}for(J(),o=l.length;o<r.length;o+=1)c(o);Q()}(!t||a&1&&s!==(s=`grid-template-columns: repeat(${(d=i[0].width)!=null?d:2}, 1fr); grid-template-rows: repeat(${(h=i[0].height)!=null?h:2}, 1fr);`))&&w(e,"style",s)},i(i){if(!t){for(let a=0;a<l.length;a+=1)z(r[a]);t=!0}},o(i){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)L(r[a]);t=!1},d(i){i&&b(e),We(r,i),n[3](null)}}}function ft(n,e,s){let{game:t}=e,l,r=0;const c=new ResizeObserver(()=>{var a;s(2,r=((a=l==null?void 0:l.clientWidth)!=null?a:0)/t.width*.8)});function i(a){de[a?"unshift":"push"](()=>{l=a,s(1,l)})}return n.$$set=a=>{"game"in a&&s(0,t=a.game)},n.$$.update=()=>{n.$$.dirty&2&&l&&c.observe(l)},[t,l,r,i]}class ct extends fe{constructor(e){super(),ce(this,e,ft,ot,ue,{game:0})}}function ut(n){var f,_,g;let e,s,t,l,r,c=((f=n[1])==null?void 0:f.numMines)+"",i,a,d,h=$e((g=(_=n[1])==null?void 0:_.stats.timePlayed)!=null?g:0)+"",o;return{c(){e=$("div"),s=$("section"),t=$("p"),l=M(n[0]),r=M(" / "),i=M(c),a=B(),d=$("p"),o=M(h),this.h()},l(u){e=I(u,"DIV",{class:!0,slot:!0});var m=C(e);s=I(m,"SECTION",{class:!0});var v=C(s);t=I(v,"P",{});var Y=C(t);l=y(Y,n[0]),r=y(Y," / "),i=y(Y,c),Y.forEach(b),a=F(v),d=I(v,"P",{});var D=C(d);o=y(D,h),D.forEach(b),v.forEach(b),m.forEach(b),this.h()},h(){var u,m,v;ne(t,"color",n[0]>=((m=(u=n[1])==null?void 0:u.numMines)!=null?m:0)?((v=n[1])==null?void 0:v.state)===W.Won?"green":"red":null,!1),w(s,"class","stats svelte-l3neex"),w(e,"class","sidebar"),w(e,"slot","sidebar")},m(u,m){P(u,e,m),p(e,s),p(s,t),p(t,l),p(t,r),p(t,i),p(s,a),p(s,d),p(d,o)},p(u,m){var v,Y,D,q,H,X;m&1&&T(l,u[0]),m&2&&c!==(c=((v=u[1])==null?void 0:v.numMines)+"")&&T(i,c),m&3&&ne(t,"color",u[0]>=((D=(Y=u[1])==null?void 0:Y.numMines)!=null?D:0)?((q=u[1])==null?void 0:q.state)===W.Won?"green":"red":null,!1),m&2&&h!==(h=$e((X=(H=u[1])==null?void 0:H.stats.timePlayed)!=null?X:0)+"")&&T(o,h)},d(u){u&&b(e)}}}function dt(n){let e,s;return{c(){e=$("p"),s=M("Loading...")},l(t){e=I(t,"P",{});var l=C(e);s=y(l,"Loading..."),l.forEach(b)},m(t,l){P(t,e,l),p(e,s)},p:A,i:A,o:A,d(t){t&&b(e)}}}function _t(n){let e,s;return e=new ct({props:{game:n[1]}}),{c(){Z(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,l){ee(e,t,l),s=!0},p(t,l){const r={};l&2&&(r.game=t[1]),e.$set(r)},i(t){s||(z(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){te(e,t)}}}function ht(n){let e,s,t,l,r,c=n[1].width+"",i,a,d=n[1].height+"",h,o,f=n[1].numMines+"",_,g;return{c(){e=$("h2"),s=M("You Lost!"),t=B(),l=$("p"),r=M("You lost on a "),i=M(c),a=M("x"),h=M(d),o=M(`\r
                        board with `),_=M(f),g=M(" mines.")},l(u){e=I(u,"H2",{});var m=C(e);s=y(m,"You Lost!"),m.forEach(b),t=F(u),l=I(u,"P",{});var v=C(l);r=y(v,"You lost on a "),i=y(v,c),a=y(v,"x"),h=y(v,d),o=y(v,`\r
                        board with `),_=y(v,f),g=y(v," mines."),v.forEach(b)},m(u,m){P(u,e,m),p(e,s),P(u,t,m),P(u,l,m),p(l,r),p(l,i),p(l,a),p(l,h),p(l,o),p(l,_),p(l,g)},p(u,m){m&2&&c!==(c=u[1].width+"")&&T(i,c),m&2&&d!==(d=u[1].height+"")&&T(h,d),m&2&&f!==(f=u[1].numMines+"")&&T(_,f)},d(u){u&&b(e),u&&b(t),u&&b(l)}}}function pt(n){let e,s,t,l,r,c=n[1].width+"",i,a,d=n[1].height+"",h,o,f=n[1].numMines+"",_,g;return{c(){e=$("h2"),s=M("You Won!"),t=B(),l=$("p"),r=M("Congratulations, you won on a "),i=M(c),a=M("x"),h=M(d),o=M(`\r
                        board with `),_=M(f),g=M(" mines.")},l(u){e=I(u,"H2",{});var m=C(e);s=y(m,"You Won!"),m.forEach(b),t=F(u),l=I(u,"P",{});var v=C(l);r=y(v,"Congratulations, you won on a "),i=y(v,c),a=y(v,"x"),h=y(v,d),o=y(v,`\r
                        board with `),_=y(v,f),g=y(v," mines."),v.forEach(b)},m(u,m){P(u,e,m),p(e,s),P(u,t,m),P(u,l,m),p(l,r),p(l,i),p(l,a),p(l,h),p(l,o),p(l,_),p(l,g)},p(u,m){m&2&&c!==(c=u[1].width+"")&&T(i,c),m&2&&d!==(d=u[1].height+"")&&T(h,d),m&2&&f!==(f=u[1].numMines+"")&&T(_,f)},d(u){u&&b(e),u&&b(t),u&&b(l)}}}function Le(n){let e,s,t;return s=new xe({props:{game:n[1],showMines:!0}}),{c(){e=$("div"),Z(s.$$.fragment),this.h()},l(l){e=I(l,"DIV",{class:!0});var r=C(e);x(s.$$.fragment,r),r.forEach(b),this.h()},h(){w(e,"class","mini-board svelte-l3neex")},m(l,r){P(l,e,r),ee(s,e,null),t=!0},p(l,r){const c={};r&2&&(c.game=l[1]),s.$set(c)},i(l){t||(z(s.$$.fragment,l),t=!0)},o(l){L(s.$$.fragment,l),t=!1},d(l){l&&b(e),te(s)}}}function mt(n){let e,s,t,l,r,c,i,a,d,h,o,f,_,g,u,m,v,Y,D,q,H,X,re,_e;const he=[_t,dt],U=[];function pe(k,S){return k[1]?0:1}s=pe(n),t=U[s]=he[s](n);function me(k,S){var V,N;if(((V=k[1])==null?void 0:V.state)===W.Won)return pt;if(((N=k[1])==null?void 0:N.state)===W.Lost)return ht}let K=me(n),G=K&&K(n);function Ye(k){n[6](k)}let be={};n[3]!==void 0&&(be.checked=n[3]),f=new Re({props:be}),de.push(()=>Xe(f,"checked",Ye));let E=n[1]&&Le(n);return{c(){e=$("div"),t.c(),l=B(),r=$("dialog"),c=$("div"),G&&G.c(),i=B(),a=$("div"),d=$("p"),h=M("Keep Game"),o=B(),Z(f.$$.fragment),g=B(),u=$("div"),m=$("button"),v=M("Back to Menu"),Y=B(),D=$("button"),q=M("New Game"),H=B(),E&&E.c(),this.h()},l(k){e=I(k,"DIV",{class:!0,slot:!0});var S=C(e);t.l(S),l=F(S),r=I(S,"DIALOG",{class:!0});var V=C(r);c=I(V,"DIV",{class:!0});var N=C(c);G&&G.l(N),i=F(N),a=I(N,"DIV",{class:!0});var le=C(a);d=I(le,"P",{class:!0});var ge=C(d);h=y(ge,"Keep Game"),ge.forEach(b),o=F(le),x(f.$$.fragment,le),le.forEach(b),g=F(N),u=I(N,"DIV",{class:!0});var se=C(u);m=I(se,"BUTTON",{class:!0});var ve=C(m);v=y(ve,"Back to Menu"),ve.forEach(b),Y=F(se),D=I(se,"BUTTON",{class:!0});var ke=C(D);q=y(ke,"New Game"),ke.forEach(b),se.forEach(b),N.forEach(b),H=F(V),E&&E.l(V),V.forEach(b),S.forEach(b),this.h()},h(){w(d,"class","svelte-l3neex"),w(a,"class","keep-game-wrapper svelte-l3neex"),w(m,"class","goto-menu"),w(D,"class","new-game"),w(u,"class","buttons-container-vertical svelte-l3neex"),w(c,"class","modal-main svelte-l3neex"),w(r,"class","aftergame-modal svelte-l3neex"),w(e,"class","wrapper svelte-l3neex"),w(e,"slot","content")},m(k,S){P(k,e,S),U[s].m(e,null),p(e,l),p(e,r),p(r,c),G&&G.m(c,null),p(c,i),p(c,a),p(a,d),p(d,h),p(a,o),ee(f,a,null),p(c,g),p(c,u),p(u,m),p(m,v),p(u,Y),p(u,D),p(D,q),p(r,H),E&&E.m(r,null),n[7](r),X=!0,re||(_e=[ie(m,"click",n[5]),ie(D,"click",n[4])],re=!0)},p(k,S){let V=s;s=pe(k),s===V?U[s].p(k,S):(J(),L(U[V],1,1,()=>{U[V]=null}),Q(),t=U[s],t?t.p(k,S):(t=U[s]=he[s](k),t.c()),z(t,1),t.m(e,l)),K===(K=me(k))&&G?G.p(k,S):(G&&G.d(1),G=K&&K(k),G&&(G.c(),G.m(c,i)));const N={};!_&&S&8&&(_=!0,N.checked=k[3],je(()=>_=!1)),f.$set(N),k[1]?E?(E.p(k,S),S&2&&z(E,1)):(E=Le(k),E.c(),z(E,1),E.m(r,null)):E&&(J(),L(E,1,1,()=>{E=null}),Q())},i(k){X||(z(t),z(f.$$.fragment,k),z(E),X=!0)},o(k){L(t),L(f.$$.fragment,k),L(E),X=!1},d(k){k&&b(e),U[s].d(),G&&G.d(),te(f),E&&E.d(),n[7](null),re=!1,Oe(_e)}}}function bt(n){let e,s;return e=new Ke({props:{fitContent:!1,$$slots:{content:[mt],sidebar:[ut]},$$scope:{ctx:n}}}),{c(){Z(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,l){ee(e,t,l),s=!0},p(t,[l]){const r={};l&1039&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){s||(z(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){te(e,t)}}}function gt(n,e,s){let t,l,r;Me(n,R,_=>s(1,l=_)),Me(n,Ae,_=>s(9,r=_));let c,i;R.subscribe(_=>{if((_==null?void 0:_.state)!==W.Playing){clearInterval(i);try{c==null||c.showModal()}catch{}}}),Te(()=>{l===null?Ie(`${Ee}`):l.state!==W.Playing&&c.showModal(),(l==null?void 0:l.state)===W.Playing&&(i=setInterval(()=>{ye(R,l.stats.timePlayed+=1,l)},1e3))}),Ue(()=>{clearInterval(i)});let a=!0;const d=()=>{clearInterval(i),a||Ce(r),Je(Qe(Ze[l.width])),c.close(),i=setInterval(()=>{ye(R,l.stats.timePlayed+=1,l)},1e3)},h=()=>{a||Ce(r),Ie(`${Ee}`),c.close()};function o(_){a=_,s(3,a)}function f(_){de[_?"unshift":"push"](()=>{c=_,s(2,c)})}return n.$$.update=()=>{n.$$.dirty&2&&s(0,t=l==null?void 0:l.board.reduce((_,g)=>_+(g.state===O.Flagged?1:0),0))},[t,l,c,a,d,h,o,f]}class Mt extends fe{constructor(e){super(),ce(this,e,gt,bt,ue,{})}}export{Mt as default};
