import{S as he,i as de,s as _e,k as I,a as D,l as C,m as E,c as V,h as g,n as w,N as se,p as q,b as P,G as b,K as ne,a0 as Ve,f as G,g as R,t as O,d as A,a1 as ze,H as fe,a2 as Be,L as Fe,A as K,U as We,V as Ie,q as M,r as y,u as W,a3 as Te,v as J,w as Q,x as Z,y as x,W as pe,o as Ue,$ as Ce,a4 as je,X as qe,Y as He}from"../../../chunks/index-5a066762.js";import{G as B,e as $,s as ae,f as U,h as Ke,r as Re,i as Ae,j as ce,k as H,S as Je,t as Ee,C as Qe,c as Ze,g as Ye,l as xe,n as et,a as tt,M as lt,d as $e}from"../../../chunks/MiniBoard-8afb9965.js";import{c as Ge}from"../../../chunks/singletons-f00f7ea7.js";const st=""+new URL("../../../assets/red_mine-cc7afd62.jpg",import.meta.url).href,nt=""+new URL("../../../assets/red_flag-cf5f7b44.jpg",import.meta.url).href,ue=(s,e)=>{var d;if(s.state!==B.Playing)return;const n=s.board[e];let l=e%s.width,t=Math.floor(e/s.height);if(n.state===$.Flagged)return;if(n.state===$.Opened&&n.numNeighborMines!==0){let o=0,a=0;for(let r=0;r<9;r++){const _=r%3-1,f=Math.floor(r/3)-1,c=_+l,h=f+t;if(c<0||c>=s.width||h<0||h>=s.height)continue;const p=h*s.width+c,u=s.board[p];(u==null?void 0:u.state)===$.Flagged&&o++}for(let r=0;r<9;r++){const _=r%3-1,f=Math.floor(r/3)-1,c=_+l,h=f+t;if(c<0||c>=s.width||h<0||h>=s.height)continue;const p=h*s.width+c,u=s.board[p];(u==null?void 0:u.state)===$.Closed&&a++}if(o===n.numNeighborMines){for(let r=0;r<9;r++){const _=r%3-1,f=Math.floor(r/3)-1,c=_+l,h=f+t;if(c<0||c>=s.width||h<0||h>=s.height)continue;const p=h*s.width+c,u=s.board[p];(u==null?void 0:u.state)===$.Closed&&ue(s,p)}return}else if(a+o===n.numNeighborMines){for(let r=0;r<9;r++){const _=r%3-1,f=Math.floor(r/3)-1,c=_+l,h=f+t;if(c<0||c>=s.width||h<0||h>=s.height)continue;const p=h*s.width+c,u=s.board[p];(u==null?void 0:u.state)===$.Closed&&Le(s,p)}return}else return}else if(n.state===$.Opened)return;if(ae.update(o=>o&&(o.cellsOpened+=1,o)),n.state=$.Opened,s.firstMove){const o=[];for(let a=0;a<9;a++){const r=a%3-1,_=Math.floor(a/3)-1,f=(t+_)*s.width+(l+r);o.push(f)}for(let a=0;a<9;a++){const r=a%3-1,_=Math.floor(a/3)-1,f=(t+_)*s.width+(l+r),c=s.board[f];(c==null?void 0:c.type)===U.Mine&&(c.type=U.Empty,Ke(s,o))}Re(s)}if(s.firstMove=!1,n.type===U.Empty&&n.numNeighborMines===0)for(let o=0;o<9;o++){const a=o%3-1,r=Math.floor(o/3)-1,_=l+a,f=t+r;if(_<0||_>=s.width||f<0||f>=s.height||a===0&&r===0)continue;const c=f*s.width+_;((d=s.board)==null?void 0:d[c].state)===$.Closed&&ue(s,c)}if(n.type===U.Mine){ae.update(o=>o&&(o.gamesLost+=1,o)),s.state=B.Lost,s.lostToCell=e;for(let o=0;o<s.width*s.height;o++){let a=s.board[o];a.type===U.Mine&&(a.state=$.Opened)}}let i=!0;for(let o=0;o<s.width*s.height;o++)s.board[o].type!==U.Mine&&s.board[o].state!==$.Opened&&(i=!1);i&&(ae.update(o=>o&&(o.gamesWon+=1,o)),s.state=B.Won)},Le=(s,e)=>{if(s.state!==B.Playing)return;let n=s.board[e];n.state===$.Closed?n.state=$.Flagged:n.state===$.Flagged&&(n.state=$.Closed)};function it(s){let e=s[0].numNeighborMines+"",n;return{c(){n=M(e)},l(l){n=y(l,e)},m(l,t){P(l,n,t)},p(l,t){t&1&&e!==(e=l[0].numNeighborMines+"")&&W(n,e)},d(l){l&&g(n)}}}function ot(s){let e,n;return{c(){e=I("img"),this.h()},l(l){e=C(l,"IMG",{alt:!0,src:!0,class:!0}),this.h()},h(){w(e,"alt","M"),Fe(e.src,n=st)||w(e,"src",n),w(e,"class","svelte-yinsfv")},m(l,t){P(l,e,t)},p:K,d(l){l&&g(e)}}}function Ne(s){let e,n,l;return{c(){e=I("div"),this.h()},l(t){e=C(t,"DIV",{class:!0}),E(e).forEach(g),this.h()},h(){var t;w(e,"class","cover svelte-yinsfv"),se(e,"light",(t=s[2])==null?void 0:t.light)},m(t,i){P(t,e,i),l=!0},p(t,i){var d;(!l||i&4)&&se(e,"light",(d=t[2])==null?void 0:d.light)},i(t){l||(n&&n.end(1),l=!0)},o(t){t&&(n=Be(e,ce,{duration:100})),l=!1},d(t){t&&g(e),t&&n&&n.end()}}}function Pe(s){let e,n,l,t;return{c(){e=I("img"),this.h()},l(i){e=C(i,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Fe(e.src,n=nt)||w(e,"src",n),w(e,"alt","F"),w(e,"class","flag svelte-yinsfv")},m(i,d){P(i,e,d),t=!0},p:K,i(i){t||(i&&We(()=>{l||(l=Ie(e,ce,{duration:100},!0)),l.run(1)}),t=!0)},o(i){i&&(l||(l=Ie(e,ce,{duration:100},!1)),l.run(0)),t=!1},d(i){i&&g(e),i&&l&&l.end()}}}function rt(s){let e,n,l,t,i=`${s[1]}px`,d,o;function a(h,p){if(h[0].type===U.Mine)return ot;if(h[0].numNeighborMines!==0)return it}let r=a(s),_=r&&r(s),f=s[0].state!==$.Opened&&Ne(s),c=s[0].state===$.Flagged&&Pe();return{c(){e=I("div"),_&&_.c(),n=D(),f&&f.c(),l=D(),c&&c.c(),this.h()},l(h){e=C(h,"DIV",{class:!0});var p=E(e);_&&_.l(p),n=V(p),f&&f.l(p),l=V(p),c&&c.l(p),p.forEach(g),this.h()},h(){var h;w(e,"class",t="wrapper "+s[0].state+" svelte-yinsfv"),se(e,"light",(h=s[2])==null?void 0:h.light),q(e,"font-size",i,!1),q(e,"cursor",s[0].numNeighborMines!==0?"pointer":null,!1)},m(h,p){P(h,e,p),_&&_.m(e,null),b(e,n),f&&f.m(e,null),b(e,l),c&&c.m(e,null),d||(o=[ne(e,"click",s[3]),ne(e,"contextmenu",Ve(s[4]))],d=!0)},p(h,[p]){var u;r===(r=a(h))&&_?_.p(h,p):(_&&_.d(1),_=r&&r(h),_&&(_.c(),_.m(e,n))),h[0].state!==$.Opened?f?(f.p(h,p),p&1&&G(f,1)):(f=Ne(h),f.c(),G(f,1),f.m(e,l)):f&&(R(),O(f,1,1,()=>{f=null}),A()),h[0].state===$.Flagged?c?(c.p(h,p),p&1&&G(c,1)):(c=Pe(),c.c(),G(c,1),c.m(e,null)):c&&(R(),O(c,1,1,()=>{c=null}),A()),p&1&&t!==(t="wrapper "+h[0].state+" svelte-yinsfv")&&w(e,"class",t),p&5&&se(e,"light",(u=h[2])==null?void 0:u.light),p&2&&i!==(i=`${h[1]}px`)&&q(e,"font-size",i,!1),p&1&&q(e,"cursor",h[0].numNeighborMines!==0?"pointer":null,!1)},i(h){G(f),G(c)},o(h){O(f),O(c)},d(h){h&&g(e),_&&_.d(),f&&f.d(),c&&c.d(),d=!1,ze(o)}}}function at(s,e,n){let l;fe(s,Ae,r=>n(2,l=r));let{cell:t}=e,{index:i}=e;const d=r=>{r.button===0&&H.update(_=>(ue(_,i),_))},o=()=>{H.update(r=>(Le(r,i),r))};let{fontSize:a}=e;return s.$$set=r=>{"cell"in r&&n(0,t=r.cell),"index"in r&&n(5,i=r.index),"fontSize"in r&&n(1,a=r.fontSize)},[t,a,l,d,o,i]}class ft extends he{constructor(e){super(),de(this,e,at,rt,_e,{cell:0,index:5,fontSize:1})}}function Se(s,e,n){const l=s.slice();return l[5]=e[n],l[7]=n,l}function Oe(s){let e,n;return e=new ft({props:{cell:s[5],index:s[7],fontSize:s[2]}}),{c(){J(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,t){Z(e,l,t),n=!0},p(l,t){const i={};t&1&&(i.cell=l[5]),t&4&&(i.fontSize=l[2]),e.$set(i)},i(l){n||(G(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){x(e,l)}}}function ct(s){let e,n,l,t=s[0].board,i=[];for(let o=0;o<t.length;o+=1)i[o]=Oe(Se(s,t,o));const d=o=>O(i[o],1,1,()=>{i[o]=null});return{c(){e=I("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=C(o,"DIV",{class:!0,style:!0});var a=E(e);for(let r=0;r<i.length;r+=1)i[r].l(a);a.forEach(g),this.h()},h(){var o,a;w(e,"class","board svelte-h57i0c"),w(e,"style",n=`grid-template-columns: repeat(${(o=s[0].width)!=null?o:2}, 1fr); grid-template-rows: repeat(${(a=s[0].height)!=null?a:2}, 1fr);`)},m(o,a){P(o,e,a);for(let r=0;r<i.length;r+=1)i[r].m(e,null);s[3](e),l=!0},p(o,[a]){var r,_;if(a&5){t=o[0].board;let f;for(f=0;f<t.length;f+=1){const c=Se(o,t,f);i[f]?(i[f].p(c,a),G(i[f],1)):(i[f]=Oe(c),i[f].c(),G(i[f],1),i[f].m(e,null))}for(R(),f=t.length;f<i.length;f+=1)d(f);A()}(!l||a&1&&n!==(n=`grid-template-columns: repeat(${(r=o[0].width)!=null?r:2}, 1fr); grid-template-rows: repeat(${(_=o[0].height)!=null?_:2}, 1fr);`))&&w(e,"style",n)},i(o){if(!l){for(let a=0;a<t.length;a+=1)G(i[a]);l=!0}},o(o){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)O(i[a]);l=!1},d(o){o&&g(e),Te(i,o),s[3](null)}}}function ut(s,e,n){let{game:l}=e,t,i=0;const d=new ResizeObserver(()=>{var a;n(2,i=((a=t==null?void 0:t.clientWidth)!=null?a:0)/l.width*.8)});function o(a){pe[a?"unshift":"push"](()=>{t=a,n(1,t)})}return s.$$set=a=>{"game"in a&&n(0,l=a.game)},s.$$.update=()=>{s.$$.dirty&2&&t&&d.observe(t)},[l,t,i,o]}class ht extends he{constructor(e){super(),de(this,e,ut,ct,_e,{game:0})}}function dt(s){var c,h,p;let e,n,l,t,i,d=((c=s[1])==null?void 0:c.numMines)+"",o,a,r,_=Ee((p=(h=s[1])==null?void 0:h.stats.timePlayed)!=null?p:0)+"",f;return{c(){e=I("div"),n=I("section"),l=I("p"),t=M(s[0]),i=M(" / "),o=M(d),a=D(),r=I("p"),f=M(_),this.h()},l(u){e=C(u,"DIV",{class:!0,slot:!0});var m=E(e);n=C(m,"SECTION",{class:!0});var v=E(n);l=C(v,"P",{});var F=E(l);t=y(F,s[0]),i=y(F," / "),o=y(F,d),F.forEach(g),a=V(v),r=C(v,"P",{});var X=E(r);f=y(X,_),X.forEach(g),v.forEach(g),m.forEach(g),this.h()},h(){q(l,"color",s[4],!1),w(n,"class","stats svelte-l3neex"),w(e,"class","sidebar"),w(e,"slot","sidebar")},m(u,m){P(u,e,m),b(e,n),b(n,l),b(l,t),b(l,i),b(l,o),b(n,a),b(n,r),b(r,f)},p(u,m){var v,F,X;m&1&&W(t,u[0]),m&2&&d!==(d=((v=u[1])==null?void 0:v.numMines)+"")&&W(o,d),m&16&&q(l,"color",u[4],!1),m&2&&_!==(_=Ee((X=(F=u[1])==null?void 0:F.stats.timePlayed)!=null?X:0)+"")&&W(f,_)},d(u){u&&g(e)}}}function _t(s){let e,n;return{c(){e=I("p"),n=M("Loading...")},l(l){e=C(l,"P",{});var t=E(e);n=y(t,"Loading..."),t.forEach(g)},m(l,t){P(l,e,t),b(e,n)},p:K,i:K,o:K,d(l){l&&g(e)}}}function pt(s){let e,n;return e=new ht({props:{game:s[1]}}),{c(){J(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,t){Z(e,l,t),n=!0},p(l,t){const i={};t&2&&(i.game=l[1]),e.$set(i)},i(l){n||(G(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){x(e,l)}}}function bt(s){let e,n,l,t,i,d=s[1].width+"",o,a,r=s[1].height+"",_,f,c=s[1].numMines+"",h,p;return{c(){e=I("h2"),n=M("You Lost!"),l=D(),t=I("p"),i=M("You lost on a "),o=M(d),a=M("x"),_=M(r),f=M(`\r
                        board with `),h=M(c),p=M(" mines.")},l(u){e=C(u,"H2",{});var m=E(e);n=y(m,"You Lost!"),m.forEach(g),l=V(u),t=C(u,"P",{});var v=E(t);i=y(v,"You lost on a "),o=y(v,d),a=y(v,"x"),_=y(v,r),f=y(v,`\r
                        board with `),h=y(v,c),p=y(v," mines."),v.forEach(g)},m(u,m){P(u,e,m),b(e,n),P(u,l,m),P(u,t,m),b(t,i),b(t,o),b(t,a),b(t,_),b(t,f),b(t,h),b(t,p)},p(u,m){m&2&&d!==(d=u[1].width+"")&&W(o,d),m&2&&r!==(r=u[1].height+"")&&W(_,r),m&2&&c!==(c=u[1].numMines+"")&&W(h,c)},d(u){u&&g(e),u&&g(l),u&&g(t)}}}function mt(s){let e,n,l,t,i,d=s[1].width+"",o,a,r=s[1].height+"",_,f,c=s[1].numMines+"",h,p;return{c(){e=I("h2"),n=M("You Won!"),l=D(),t=I("p"),i=M("Congratulations, you won on a "),o=M(d),a=M("x"),_=M(r),f=M(`\r
                        board with `),h=M(c),p=M(" mines.")},l(u){e=C(u,"H2",{});var m=E(e);n=y(m,"You Won!"),m.forEach(g),l=V(u),t=C(u,"P",{});var v=E(t);i=y(v,"Congratulations, you won on a "),o=y(v,d),a=y(v,"x"),_=y(v,r),f=y(v,`\r
                        board with `),h=y(v,c),p=y(v," mines."),v.forEach(g)},m(u,m){P(u,e,m),b(e,n),P(u,l,m),P(u,t,m),b(t,i),b(t,o),b(t,a),b(t,_),b(t,f),b(t,h),b(t,p)},p(u,m){m&2&&d!==(d=u[1].width+"")&&W(o,d),m&2&&r!==(r=u[1].height+"")&&W(_,r),m&2&&c!==(c=u[1].numMines+"")&&W(h,c)},d(u){u&&g(e),u&&g(l),u&&g(t)}}}function Xe(s){let e,n,l;return n=new lt({props:{game:s[1],showMines:!0}}),{c(){e=I("div"),J(n.$$.fragment),this.h()},l(t){e=C(t,"DIV",{class:!0});var i=E(e);Q(n.$$.fragment,i),i.forEach(g),this.h()},h(){w(e,"class","mini-board svelte-l3neex")},m(t,i){P(t,e,i),Z(n,e,null),l=!0},p(t,i){const d={};i&2&&(d.game=t[1]),n.$set(d)},i(t){l||(G(n.$$.fragment,t),l=!0)},o(t){O(n.$$.fragment,t),l=!1},d(t){t&&g(e),x(n)}}}function gt(s){let e,n,l,t,i,d,o,a,r,_,f,c,h,p,u,m,v,F,X,ie,oe,ee,re,be;const me=[pt,_t],T=[];function ge(k,S){return k[1]?0:1}n=ge(s),l=T[n]=me[n](s);function ve(k,S){var L,z;if(((L=k[1])==null?void 0:L.state)===B.Won)return mt;if(((z=k[1])==null?void 0:z.state)===B.Lost)return bt}let j=ve(s),N=j&&j(s);function De(k){s[7](k)}let ke={};s[3]!==void 0&&(ke.checked=s[3]),c=new Qe({props:ke}),pe.push(()=>qe(c,"checked",De));let Y=s[1]&&Xe(s);return{c(){e=I("div"),l.c(),t=D(),i=I("dialog"),d=I("div"),N&&N.c(),o=D(),a=I("div"),r=I("p"),_=M("Keep Game"),f=D(),J(c.$$.fragment),p=D(),u=I("div"),m=I("button"),v=M("Back to Menu"),F=D(),X=I("button"),ie=M("New Game"),oe=D(),Y&&Y.c(),this.h()},l(k){e=C(k,"DIV",{class:!0,slot:!0});var S=E(e);l.l(S),t=V(S),i=C(S,"DIALOG",{class:!0});var L=E(i);d=C(L,"DIV",{class:!0});var z=E(d);N&&N.l(z),o=V(z),a=C(z,"DIV",{class:!0});var te=E(a);r=C(te,"P",{class:!0});var we=E(r);_=y(we,"Keep Game"),we.forEach(g),f=V(te),Q(c.$$.fragment,te),te.forEach(g),p=V(z),u=C(z,"DIV",{class:!0});var le=E(u);m=C(le,"BUTTON",{class:!0});var Me=E(m);v=y(Me,"Back to Menu"),Me.forEach(g),F=V(le),X=C(le,"BUTTON",{class:!0});var ye=E(X);ie=y(ye,"New Game"),ye.forEach(g),le.forEach(g),z.forEach(g),oe=V(L),Y&&Y.l(L),L.forEach(g),S.forEach(g),this.h()},h(){w(r,"class","svelte-l3neex"),w(a,"class","keep-game-wrapper svelte-l3neex"),w(m,"class","goto-menu"),w(X,"class","new-game"),w(u,"class","buttons-container-vertical svelte-l3neex"),w(d,"class","modal-main svelte-l3neex"),w(i,"class","aftergame-modal svelte-l3neex"),w(e,"class","wrapper svelte-l3neex"),w(e,"slot","content")},m(k,S){P(k,e,S),T[n].m(e,null),b(e,t),b(e,i),b(i,d),N&&N.m(d,null),b(d,o),b(d,a),b(a,r),b(r,_),b(a,f),Z(c,a,null),b(d,p),b(d,u),b(u,m),b(m,v),b(u,F),b(u,X),b(X,ie),b(i,oe),Y&&Y.m(i,null),s[8](i),ee=!0,re||(be=[ne(m,"click",s[6]),ne(X,"click",s[5])],re=!0)},p(k,S){let L=n;n=ge(k),n===L?T[n].p(k,S):(R(),O(T[L],1,1,()=>{T[L]=null}),A(),l=T[n],l?l.p(k,S):(l=T[n]=me[n](k),l.c()),G(l,1),l.m(e,t)),j===(j=ve(k))&&N?N.p(k,S):(N&&N.d(1),N=j&&j(k),N&&(N.c(),N.m(d,o)));const z={};!h&&S&8&&(h=!0,z.checked=k[3],He(()=>h=!1)),c.$set(z),k[1]?Y?(Y.p(k,S),S&2&&G(Y,1)):(Y=Xe(k),Y.c(),G(Y,1),Y.m(i,null)):Y&&(R(),O(Y,1,1,()=>{Y=null}),A())},i(k){ee||(G(l),G(c.$$.fragment,k),G(Y),ee=!0)},o(k){O(l),O(c.$$.fragment,k),O(Y),ee=!1},d(k){k&&g(e),T[n].d(),N&&N.d(),x(c),Y&&Y.d(),s[8](null),re=!1,ze(be)}}}function vt(s){let e,n;return e=new Je({props:{fullContent:!0,$$slots:{content:[gt],sidebar:[dt]},$$scope:{ctx:s}}}),{c(){J(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,t){Z(e,l,t),n=!0},p(l,[t]){const i={};t&2079&&(i.$$scope={dirty:t,ctx:l}),e.$set(i)},i(l){n||(G(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){x(e,l)}}}function kt(s,e,n){let l,t,i;fe(s,H,p=>n(1,t=p)),fe(s,Ze,p=>n(10,i=p));let d,o;H.subscribe(p=>{if((p==null?void 0:p.state)!==B.Playing){clearInterval(o);try{d==null||d.showModal()}catch{}}}),Ue(()=>{t===null?Ye(`${Ge}`):t.state!==B.Playing&&d.showModal(),(t==null?void 0:t.state)===B.Playing&&(o=setInterval(()=>{Ce(H,t.stats.timePlayed+=1,t)},1e3))}),je(()=>{clearInterval(o)});let a=!0;const r=()=>{clearInterval(o),a||$e(i),xe(et(tt[t.width])),d.close(),o=setInterval(()=>{Ce(H,t.stats.timePlayed+=1,t)},1e3)},_=()=>{a||$e(i),Ye(`${Ge}`),d.close()};let f;function c(p){a=p,n(3,a)}function h(p){pe[p?"unshift":"push"](()=>{d=p,n(2,d)})}return s.$$.update=()=>{var p,u;s.$$.dirty&2&&n(0,l=t==null?void 0:t.board.reduce((m,v)=>m+(v.state===$.Flagged?1:0),0)),s.$$.dirty&3&&(l>((p=t==null?void 0:t.numMines)!=null?p:0)?n(4,f="red"):l===((u=t==null?void 0:t.numMines)!=null?u:0)&&(t==null?void 0:t.state)===B.Won?n(4,f="green"):n(4,f=null))},[l,t,d,a,f,r,_,c,h]}class It extends he{constructor(e){super(),de(this,e,kt,vt,_e,{})}}export{It as default};
