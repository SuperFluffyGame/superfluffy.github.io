import{S as oe,i as fe,s as ce,k as y,a as F,l as I,m as E,c as V,h as b,n as w,p as ne,b as P,G as p,J as ie,a0 as Le,f as G,g as A,t as N,d as Q,a1 as Ne,a2 as Ye,K as Oe,A as R,_ as Fe,$ as ke,q as M,r as $,u as j,a3 as Ve,v as Z,w as x,x as ee,y as te,M as ue,H as we,o as je,Q as Me,a4 as Te,N as We,O as Ue}from"../../../chunks/index-35a657ee.js";import{G as T,b as O,e as X,s as Xe,r as qe,f as re,h as K,S as He,t as $e,C as Je,c as Ke,g as ye,a as Re,n as Ae,B as Qe,M as Ze,d as Ie}from"../../../chunks/SidebarLayout-e6757cc4.js";import{c as Ee}from"../../../chunks/singletons-e66b99f8.js";const xe=""+new URL("../../../assets/red_mine-cc7afd62.jpg",import.meta.url).href,et=""+new URL("../../../assets/red_flag-cf5f7b44.jpg",import.meta.url).href,De=(n,e)=>{var c;if(n.state!==T.Playing)return;const s=n.board[e];if(s.state===O.Flagged)return;let t=e%n.width,l=Math.floor(e/n.height);if(s.state=O.Opened,n.firstMove){const r=[];for(let a=0;a<9;a++){const d=a%3-1,h=Math.floor(a/3)-1,o=(l+h)*n.width+(t+d);r.push(o)}for(let a=0;a<9;a++){const d=a%3-1,h=Math.floor(a/3)-1,o=(l+h)*n.width+(t+d),f=n.board[o];(f==null?void 0:f.type)===X.Mine&&(f.type=X.Empty,Xe(n,r))}qe(n)}if(n.firstMove=!1,s.type===X.Empty&&s.numNeighborMines===0)for(let r=0;r<9;r++){const a=r%3-1,d=Math.floor(r/3)-1,h=t+a,o=l+d;if(h<0||h>=n.width||o<0||o>=n.height||a===0&&d===0)continue;const f=o*n.width+h;((c=n.board)==null?void 0:c[f].state)===O.Closed&&De(n,f)}if(s.type===X.Mine){n.state=T.Lost,n.lostToCell=e;for(let r=0;r<n.width*n.height;r++){let a=n.board[r];a.type===X.Mine&&(a.state=O.Opened)}}let i=!0;for(let r=0;r<n.width*n.height;r++)n.board[r].type!==X.Mine&&n.board[r].state!==O.Opened&&(i=!1);i&&(n.state=T.Won)},tt=(n,e)=>{let s=n.board[e];s.state===O.Closed?s.state=O.Flagged:s.state===O.Flagged&&(s.state=O.Closed)};function lt(n){let e=n[0].numNeighborMines+"",s;return{c(){s=M(e)},l(t){s=$(t,e)},m(t,l){P(t,s,l)},p(t,l){l&1&&e!==(e=t[0].numNeighborMines+"")&&j(s,e)},d(t){t&&b(s)}}}function st(n){let e,s;return{c(){e=y("img"),this.h()},l(t){e=I(t,"IMG",{alt:!0,src:!0,class:!0}),this.h()},h(){w(e,"alt","M"),Oe(e.src,s=xe)||w(e,"src",s),w(e,"class","svelte-m4je3a")},m(t,l){P(t,e,l)},p:R,d(t){t&&b(e)}}}function Ce(n){let e,s,t;return{c(){e=y("div"),this.h()},l(l){e=I(l,"DIV",{class:!0}),E(e).forEach(b),this.h()},h(){w(e,"class","cover svelte-m4je3a")},m(l,i){P(l,e,i),t=!0},i(l){t||(s&&s.end(1),t=!0)},o(l){l&&(s=Ye(e,re,{duration:100})),t=!1},d(l){l&&b(e),l&&s&&s.end()}}}function Ge(n){let e,s,t,l;return{c(){e=y("img"),this.h()},l(i){e=I(i,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Oe(e.src,s=et)||w(e,"src",s),w(e,"alt","F"),w(e,"class","flag svelte-m4je3a")},m(i,c){P(i,e,c),l=!0},p:R,i(i){l||(i&&Fe(()=>{t||(t=ke(e,re,{duration:100},!0)),t.run(1)}),l=!0)},o(i){i&&(t||(t=ke(e,re,{duration:100},!1)),t.run(0)),l=!1},d(i){i&&b(e),i&&t&&t.end()}}}function nt(n){let e,s,t,l,i=`${n[1]}px`,c,r;function a(_,v){if(_[0].type===X.Mine)return st;if(_[0].numNeighborMines!==0)return lt}let d=a(n),h=d&&d(n),o=n[0].state!==O.Opened&&Ce(),f=n[0].state===O.Flagged&&Ge();return{c(){e=y("div"),h&&h.c(),s=F(),o&&o.c(),t=F(),f&&f.c(),this.h()},l(_){e=I(_,"DIV",{class:!0});var v=E(e);h&&h.l(v),s=V(v),o&&o.l(v),t=V(v),f&&f.l(v),v.forEach(b),this.h()},h(){w(e,"class",l="wrapper "+n[0].state+" svelte-m4je3a"),ne(e,"font-size",i,!1)},m(_,v){P(_,e,v),h&&h.m(e,null),p(e,s),o&&o.m(e,null),p(e,t),f&&f.m(e,null),c||(r=[ie(e,"click",n[2]),ie(e,"contextmenu",Le(n[3]))],c=!0)},p(_,[v]){d===(d=a(_))&&h?h.p(_,v):(h&&h.d(1),h=d&&d(_),h&&(h.c(),h.m(e,s))),_[0].state!==O.Opened?o?v&1&&G(o,1):(o=Ce(),o.c(),G(o,1),o.m(e,t)):o&&(A(),N(o,1,1,()=>{o=null}),Q()),_[0].state===O.Flagged?f?(f.p(_,v),v&1&&G(f,1)):(f=Ge(),f.c(),G(f,1),f.m(e,null)):f&&(A(),N(f,1,1,()=>{f=null}),Q()),v&1&&l!==(l="wrapper "+_[0].state+" svelte-m4je3a")&&w(e,"class",l),v&2&&i!==(i=`${_[1]}px`)&&ne(e,"font-size",i,!1)},i(_){G(o),G(f)},o(_){N(o),N(f)},d(_){_&&b(e),h&&h.d(),o&&o.d(),f&&f.d(),c=!1,Ne(r)}}}function it(n,e,s){let{cell:t}=e,{index:l}=e;const i=a=>{a.button===0&&K.update(d=>(De(d,l),d))},c=()=>{K.update(a=>(tt(a,l),a))};let{fontSize:r}=e;return n.$$set=a=>{"cell"in a&&s(0,t=a.cell),"index"in a&&s(4,l=a.index),"fontSize"in a&&s(1,r=a.fontSize)},[t,r,i,c,l]}class at extends oe{constructor(e){super(),fe(this,e,it,nt,ce,{cell:0,index:4,fontSize:1})}}function Se(n,e,s){const t=n.slice();return t[5]=e[s],t[7]=s,t}function Pe(n){let e,s;return e=new at({props:{cell:n[5],index:n[7],fontSize:n[2]}}),{c(){Z(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,l){ee(e,t,l),s=!0},p(t,l){const i={};l&1&&(i.cell=t[5]),l&4&&(i.fontSize=t[2]),e.$set(i)},i(t){s||(G(e.$$.fragment,t),s=!0)},o(t){N(e.$$.fragment,t),s=!1},d(t){te(e,t)}}}function rt(n){let e,s,t,l=n[0].board,i=[];for(let r=0;r<l.length;r+=1)i[r]=Pe(Se(n,l,r));const c=r=>N(i[r],1,1,()=>{i[r]=null});return{c(){e=y("div");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){e=I(r,"DIV",{class:!0,style:!0});var a=E(e);for(let d=0;d<i.length;d+=1)i[d].l(a);a.forEach(b),this.h()},h(){var r,a;w(e,"class","board svelte-h57i0c"),w(e,"style",s=`grid-template-columns: repeat(${(r=n[0].width)!=null?r:2}, 1fr); grid-template-rows: repeat(${(a=n[0].height)!=null?a:2}, 1fr);`)},m(r,a){P(r,e,a);for(let d=0;d<i.length;d+=1)i[d].m(e,null);n[3](e),t=!0},p(r,[a]){var d,h;if(a&5){l=r[0].board;let o;for(o=0;o<l.length;o+=1){const f=Se(r,l,o);i[o]?(i[o].p(f,a),G(i[o],1)):(i[o]=Pe(f),i[o].c(),G(i[o],1),i[o].m(e,null))}for(A(),o=l.length;o<i.length;o+=1)c(o);Q()}(!t||a&1&&s!==(s=`grid-template-columns: repeat(${(d=r[0].width)!=null?d:2}, 1fr); grid-template-rows: repeat(${(h=r[0].height)!=null?h:2}, 1fr);`))&&w(e,"style",s)},i(r){if(!t){for(let a=0;a<l.length;a+=1)G(i[a]);t=!0}},o(r){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)N(i[a]);t=!1},d(r){r&&b(e),Ve(i,r),n[3](null)}}}function ot(n,e,s){let{game:t}=e,l,i=0;const c=new ResizeObserver(()=>{var a;s(2,i=((a=l==null?void 0:l.clientWidth)!=null?a:0)/t.width*.8)});function r(a){ue[a?"unshift":"push"](()=>{l=a,s(1,l)})}return n.$$set=a=>{"game"in a&&s(0,t=a.game)},n.$$.update=()=>{n.$$.dirty&2&&l&&c.observe(l)},[t,l,i,r]}class ft extends oe{constructor(e){super(),fe(this,e,ot,rt,ce,{game:0})}}function ct(n){var f,_,v;let e,s,t,l,i,c=((f=n[1])==null?void 0:f.numMines)+"",r,a,d,h=$e((v=(_=n[1])==null?void 0:_.stats.timePlayed)!=null?v:0)+"",o;return{c(){e=y("div"),s=y("section"),t=y("p"),l=M(n[0]),i=M(" / "),r=M(c),a=F(),d=y("p"),o=M(h),this.h()},l(u){e=I(u,"DIV",{class:!0,slot:!0});var m=E(e);s=I(m,"SECTION",{class:!0});var g=E(s);t=I(g,"P",{});var L=E(t);l=$(L,n[0]),i=$(L," / "),r=$(L,c),L.forEach(b),a=V(g),d=I(g,"P",{});var D=E(d);o=$(D,h),D.forEach(b),g.forEach(b),m.forEach(b),this.h()},h(){var u,m,g;ne(t,"color",n[0]>=((m=(u=n[1])==null?void 0:u.numMines)!=null?m:0)?((g=n[1])==null?void 0:g.state)===T.Won?"green":"red":null,!1),w(s,"class","stats svelte-l3neex"),w(e,"class","sidebar"),w(e,"slot","sidebar")},m(u,m){P(u,e,m),p(e,s),p(s,t),p(t,l),p(t,i),p(t,r),p(s,a),p(s,d),p(d,o)},p(u,m){var g,L,D,q,H,U;m&1&&j(l,u[0]),m&2&&c!==(c=((g=u[1])==null?void 0:g.numMines)+"")&&j(r,c),m&3&&ne(t,"color",u[0]>=((D=(L=u[1])==null?void 0:L.numMines)!=null?D:0)?((q=u[1])==null?void 0:q.state)===T.Won?"green":"red":null,!1),m&2&&h!==(h=$e((U=(H=u[1])==null?void 0:H.stats.timePlayed)!=null?U:0)+"")&&j(o,h)},d(u){u&&b(e)}}}function ut(n){let e,s;return{c(){e=y("p"),s=M("Loading...")},l(t){e=I(t,"P",{});var l=E(e);s=$(l,"Loading..."),l.forEach(b)},m(t,l){P(t,e,l),p(e,s)},p:R,i:R,o:R,d(t){t&&b(e)}}}function dt(n){let e,s;return e=new ft({props:{game:n[1]}}),{c(){Z(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,l){ee(e,t,l),s=!0},p(t,l){const i={};l&2&&(i.game=t[1]),e.$set(i)},i(t){s||(G(e.$$.fragment,t),s=!0)},o(t){N(e.$$.fragment,t),s=!1},d(t){te(e,t)}}}function _t(n){let e,s,t,l,i,c=n[1].width+"",r,a,d=n[1].height+"",h,o,f=n[1].numMines+"",_,v;return{c(){e=y("h2"),s=M("You Lost!"),t=F(),l=y("p"),i=M("You lost on a "),r=M(c),a=M("x"),h=M(d),o=M(`\r
                        board with `),_=M(f),v=M(" mines.")},l(u){e=I(u,"H2",{});var m=E(e);s=$(m,"You Lost!"),m.forEach(b),t=V(u),l=I(u,"P",{});var g=E(l);i=$(g,"You lost on a "),r=$(g,c),a=$(g,"x"),h=$(g,d),o=$(g,`\r
                        board with `),_=$(g,f),v=$(g," mines."),g.forEach(b)},m(u,m){P(u,e,m),p(e,s),P(u,t,m),P(u,l,m),p(l,i),p(l,r),p(l,a),p(l,h),p(l,o),p(l,_),p(l,v)},p(u,m){m&2&&c!==(c=u[1].width+"")&&j(r,c),m&2&&d!==(d=u[1].height+"")&&j(h,d),m&2&&f!==(f=u[1].numMines+"")&&j(_,f)},d(u){u&&b(e),u&&b(t),u&&b(l)}}}function ht(n){let e,s,t,l,i,c=n[1].width+"",r,a,d=n[1].height+"",h,o,f=n[1].numMines+"",_,v;return{c(){e=y("h2"),s=M("You Won!"),t=F(),l=y("p"),i=M("Congratulations, you won on a "),r=M(c),a=M("x"),h=M(d),o=M(`\r
                        board with `),_=M(f),v=M(" mines.")},l(u){e=I(u,"H2",{});var m=E(e);s=$(m,"You Won!"),m.forEach(b),t=V(u),l=I(u,"P",{});var g=E(l);i=$(g,"Congratulations, you won on a "),r=$(g,c),a=$(g,"x"),h=$(g,d),o=$(g,`\r
                        board with `),_=$(g,f),v=$(g," mines."),g.forEach(b)},m(u,m){P(u,e,m),p(e,s),P(u,t,m),P(u,l,m),p(l,i),p(l,r),p(l,a),p(l,h),p(l,o),p(l,_),p(l,v)},p(u,m){m&2&&c!==(c=u[1].width+"")&&j(r,c),m&2&&d!==(d=u[1].height+"")&&j(h,d),m&2&&f!==(f=u[1].numMines+"")&&j(_,f)},d(u){u&&b(e),u&&b(t),u&&b(l)}}}function ze(n){let e,s,t;return s=new Ze({props:{game:n[1],showMines:!0}}),{c(){e=y("div"),Z(s.$$.fragment),this.h()},l(l){e=I(l,"DIV",{class:!0});var i=E(e);x(s.$$.fragment,i),i.forEach(b),this.h()},h(){w(e,"class","mini-board svelte-l3neex")},m(l,i){P(l,e,i),ee(s,e,null),t=!0},p(l,i){const c={};i&2&&(c.game=l[1]),s.$set(c)},i(l){t||(G(s.$$.fragment,l),t=!0)},o(l){N(s.$$.fragment,l),t=!1},d(l){l&&b(e),te(s)}}}function pt(n){let e,s,t,l,i,c,r,a,d,h,o,f,_,v,u,m,g,L,D,q,H,U,ae,de;const _e=[dt,ut],W=[];function he(k,z){return k[1]?0:1}s=he(n),t=W[s]=_e[s](n);function pe(k,z){var Y,B;if(((Y=k[1])==null?void 0:Y.state)===T.Won)return ht;if(((B=k[1])==null?void 0:B.state)===T.Lost)return _t}let J=pe(n),S=J&&J(n);function Be(k){n[6](k)}let me={};n[3]!==void 0&&(me.checked=n[3]),f=new Je({props:me}),ue.push(()=>We(f,"checked",Be));let C=n[1]&&ze(n);return{c(){e=y("div"),t.c(),l=F(),i=y("dialog"),c=y("div"),S&&S.c(),r=F(),a=y("div"),d=y("p"),h=M("Keep Game"),o=F(),Z(f.$$.fragment),v=F(),u=y("div"),m=y("button"),g=M("Back to Menu"),L=F(),D=y("button"),q=M("New Game"),H=F(),C&&C.c(),this.h()},l(k){e=I(k,"DIV",{class:!0,slot:!0});var z=E(e);t.l(z),l=V(z),i=I(z,"DIALOG",{class:!0});var Y=E(i);c=I(Y,"DIV",{class:!0});var B=E(c);S&&S.l(B),r=V(B),a=I(B,"DIV",{class:!0});var le=E(a);d=I(le,"P",{class:!0});var be=E(d);h=$(be,"Keep Game"),be.forEach(b),o=V(le),x(f.$$.fragment,le),le.forEach(b),v=V(B),u=I(B,"DIV",{class:!0});var se=E(u);m=I(se,"BUTTON",{class:!0});var ve=E(m);g=$(ve,"Back to Menu"),ve.forEach(b),L=V(se),D=I(se,"BUTTON",{class:!0});var ge=E(D);q=$(ge,"New Game"),ge.forEach(b),se.forEach(b),B.forEach(b),H=V(Y),C&&C.l(Y),Y.forEach(b),z.forEach(b),this.h()},h(){w(d,"class","svelte-l3neex"),w(a,"class","keep-game-wrapper svelte-l3neex"),w(m,"class","goto-menu"),w(D,"class","new-game"),w(u,"class","buttons-container-vertical svelte-l3neex"),w(c,"class","modal-main svelte-l3neex"),w(i,"class","aftergame-modal svelte-l3neex"),w(e,"class","wrapper svelte-l3neex"),w(e,"slot","content")},m(k,z){P(k,e,z),W[s].m(e,null),p(e,l),p(e,i),p(i,c),S&&S.m(c,null),p(c,r),p(c,a),p(a,d),p(d,h),p(a,o),ee(f,a,null),p(c,v),p(c,u),p(u,m),p(m,g),p(u,L),p(u,D),p(D,q),p(i,H),C&&C.m(i,null),n[7](i),U=!0,ae||(de=[ie(m,"click",n[5]),ie(D,"click",n[4])],ae=!0)},p(k,z){let Y=s;s=he(k),s===Y?W[s].p(k,z):(A(),N(W[Y],1,1,()=>{W[Y]=null}),Q(),t=W[s],t?t.p(k,z):(t=W[s]=_e[s](k),t.c()),G(t,1),t.m(e,l)),J===(J=pe(k))&&S?S.p(k,z):(S&&S.d(1),S=J&&J(k),S&&(S.c(),S.m(c,r)));const B={};!_&&z&8&&(_=!0,B.checked=k[3],Ue(()=>_=!1)),f.$set(B),k[1]?C?(C.p(k,z),z&2&&G(C,1)):(C=ze(k),C.c(),G(C,1),C.m(i,null)):C&&(A(),N(C,1,1,()=>{C=null}),Q())},i(k){U||(G(t),G(f.$$.fragment,k),G(C),U=!0)},o(k){N(t),N(f.$$.fragment,k),N(C),U=!1},d(k){k&&b(e),W[s].d(),S&&S.d(),te(f),C&&C.d(),n[7](null),ae=!1,Ne(de)}}}function mt(n){let e,s;return e=new He({props:{$$slots:{content:[pt],sidebar:[ct]},$$scope:{ctx:n}}}),{c(){Z(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,l){ee(e,t,l),s=!0},p(t,[l]){const i={};l&1039&&(i.$$scope={dirty:l,ctx:t}),e.$set(i)},i(t){s||(G(e.$$.fragment,t),s=!0)},o(t){N(e.$$.fragment,t),s=!1},d(t){te(e,t)}}}function bt(n,e,s){let t,l,i;we(n,K,_=>s(1,l=_)),we(n,Ke,_=>s(9,i=_));let c,r;K.subscribe(_=>{if((_==null?void 0:_.state)!==T.Playing){clearInterval(r);try{c==null||c.showModal()}catch{}}}),je(()=>{l===null?ye(`${Ee}`):l.state!==T.Playing&&c.showModal(),(l==null?void 0:l.state)===T.Playing&&(r=setInterval(()=>{Me(K,l.stats.timePlayed+=1,l)},1e3))}),Te(()=>{clearInterval(r)});let a=!0;const d=()=>{clearInterval(r),a||Ie(i),Re(Ae(Qe[l.width])),c.close(),r=setInterval(()=>{Me(K,l.stats.timePlayed+=1,l)},1e3)},h=()=>{a||Ie(i),ye(`${Ee}`),c.close()};function o(_){a=_,s(3,a)}function f(_){ue[_?"unshift":"push"](()=>{c=_,s(2,c)})}return n.$$.update=()=>{n.$$.dirty&2&&s(0,t=l==null?void 0:l.board.reduce((_,v)=>_+(v.state===O.Flagged?1:0),0))},[t,l,c,a,d,h,o,f]}class wt extends oe{constructor(e){super(),fe(this,e,bt,mt,ce,{})}}export{wt as default};
