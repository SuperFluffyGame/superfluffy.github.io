var C=Object.defineProperty;var J=(e,t,s)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var p=(e,t,s)=>(J(e,typeof t!="symbol"?t+"":t,s),s);import{w as b,d as h}from"./singletons-ccdced21.js";import{M as L,S as R,i as T,s as F,k as A,l as G,m as k,h as M,n as _,b as V,A as S,L as B,N as f}from"./index-fdc6cb39.js";function D(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}const y="MINESWEEPER_SAVE_SLOTS",E="MINESWEEPER_SAVE_GAME",X=e=>{let t=localStorage[E+`_${e}`];return t?JSON.parse(t):null},P=(e,t)=>{Y(e),localStorage[E+`_${e}`]=JSON.stringify(t)},Y=e=>{localStorage.removeItem(E+`_${e}`)},ne="v0.0.2";let W=b(null);W.subscribe(e=>{if(typeof window<"u"&&e!=null){let t=L(m);P(t,e)}});let m=b(-1);m.subscribe(e=>{typeof window<"u"&&e!=null&&e!=-1&&W.set(X(e))});let v=b(null);v.subscribe(e=>{typeof window<"u"&&e!=null&&(localStorage[y]=JSON.stringify(e))});var O;typeof window<"u"&&v.set(JSON.parse((O=localStorage[y])!=null?O:"[]"));var u=(e=>(e.Closed="closed",e.Opened="opened",e.Flagged="flagged",e))(u||{}),d=(e=>(e.Empty="empty",e.Mine="mine",e))(d||{}),j=(e=>(e.Playing="playing",e.Won="won",e.Lost="lost",e))(j||{});function q({width:e,height:t,numMines:s}){let l=Array(e*t);for(let o=0;o<e;o++)for(let n=0;n<t;n++){const i=n*e+o;l[i]={state:"closed",numNeighborMines:0,type:"empty"}}return l}var Z,$,z;class w{}Z=8,$=12,z=16,p(w,Z,{width:8,height:8,numMines:10}),p(w,$,{width:12,height:12,numMines:20}),p(w,z,{width:16,height:16,numMines:40});const se=e=>{const s={board:q(e),...e,firstMove:!0,state:"playing",lostToCell:-1,title:"Save Game "};for(let n=0;n<e.numMines;n++)H(s);K(s);let l=localStorage[y],o;for(let n=0;;n++)if(l.indexOf(n)===-1){o=n;break}s.title+=o,P(o,s),m.set(-1),m.set(o),v.update(n=>{var i;return(i=n==null?void 0:n.push)==null||i.call(n,o),n})},H=e=>{const t=[];for(let l=0;l<e.width*e.height;l++)e.board[l].type==="empty"&&t.push(l);const s=t[D(0,t.length)];e.board[s].type="mine"},K=e=>{for(let t=0;t<(e==null?void 0:e.width);t++)for(let s=0;s<(e==null?void 0:e.height);s++){let l=0;for(let n=0;n<9;n++){const i=Math.floor(n/3)-1,r=n%3-1,c=t+i,a=s+r;if(c<0||c>=e.width||a<0||a>=e.height)continue;const g=a*e.width+c;e.board[g].type==="mine"&&(l+=1)}const o=s*e.width+t;e.board[o].numNeighborMines=l}};h.disable_scroll_handling;const le=h.goto;h.invalidate;h.invalidateAll;h.prefetch;h.prefetch_routes;h.before_navigate;h.after_navigate;function N(e,t,s){const l=e.slice();return l[2]=t[s],l[4]=s,l}function I(e){let t;return{c(){t=A("div"),this.h()},l(s){t=G(s,"DIV",{class:!0}),k(t).forEach(M),this.h()},h(){_(t,"class","svelte-bu3tdx"),f(t,"cell",e[2]),f(t,"open",e[2].state===u.Opened),f(t,"empty",e[2].type!==d.Mine||e[2].type===d.Mine&&!e[0]),f(t,"mine",e[2].type===d.Mine&&e[0]),f(t,"flag",e[2].state===u.Flagged&&!e[0]),f(t,"clicked-mine",e[1].lostToCell===e[4]&&e[0])},m(s,l){V(s,t,l)},p(s,l){l&2&&f(t,"cell",s[2]),l&2&&f(t,"open",s[2].state===u.Opened),l&3&&f(t,"empty",s[2].type!==d.Mine||s[2].type===d.Mine&&!s[0]),l&3&&f(t,"mine",s[2].type===d.Mine&&s[0]),l&3&&f(t,"flag",s[2].state===u.Flagged&&!s[0]),l&3&&f(t,"clicked-mine",s[1].lostToCell===s[4]&&s[0])},d(s){s&&M(t)}}}function Q(e){let t,s,l=e[1].board,o=[];for(let n=0;n<l.length;n+=1)o[n]=I(N(e,l,n));return{c(){t=A("div");for(let n=0;n<o.length;n+=1)o[n].c();this.h()},l(n){t=G(n,"DIV",{class:!0,style:!0});var i=k(t);for(let r=0;r<o.length;r+=1)o[r].l(i);i.forEach(M),this.h()},h(){var n,i;_(t,"class","wrapper svelte-bu3tdx"),_(t,"style",s=`grid-template-columns: repeat(${(n=e[1].width)!=null?n:2}, 1fr); grid-template-rows: repeat(${(i=e[1].height)!=null?i:2}, 1fr);`)},m(n,i){V(n,t,i);for(let r=0;r<o.length;r+=1)o[r].m(t,null)},p(n,[i]){var r,c;if(i&3){l=n[1].board;let a;for(a=0;a<l.length;a+=1){const g=N(n,l,a);o[a]?o[a].p(g,i):(o[a]=I(g),o[a].c(),o[a].m(t,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=l.length}i&2&&s!==(s=`grid-template-columns: repeat(${(r=n[1].width)!=null?r:2}, 1fr); grid-template-rows: repeat(${(c=n[1].height)!=null?c:2}, 1fr);`)&&_(t,"style",s)},i:S,o:S,d(n){n&&M(t),B(o,n)}}}function U(e,t,s){let{showMines:l=!1}=t,{game:o}=t;return e.$$set=n=>{"showMines"in n&&s(0,l=n.showMines),"game"in n&&s(1,o=n.game)},[l,o]}class oe extends R{constructor(t){super(),T(this,t,U,Q,F,{showMines:0,game:1})}}export{w as B,u as C,j as G,oe as M,d as a,W as b,m as c,Y as d,E as e,le as g,X as l,se as n,K as r,H as s,v as u,ne as v};
