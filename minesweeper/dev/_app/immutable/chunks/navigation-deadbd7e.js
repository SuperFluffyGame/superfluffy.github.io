var S=Object.defineProperty;var N=(e,t,o)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var a=(e,t,o)=>(N(e,typeof t!="symbol"?t+"":t,o),o);import{w as h,d as i}from"./singletons-31601b89.js";import{N as v}from"./index-de395be4.js";function I(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}const p="MINESWEEPER_SAVE_SLOTS",M="MINESWEEPER_SAVE_GAME",A=e=>{let t=localStorage[M+`_${e}`];return t?JSON.parse(t):null},w=(e,t)=>{G(e),localStorage[M+`_${e}`]=JSON.stringify(t)},G=e=>{localStorage.removeItem(M+`_${e}`)},X="v0.0.2";let _=h(null);_.subscribe(e=>{if(typeof window<"u"&&e!=null){let t=v(c);w(t,e)}});let c=h(-1);c.subscribe(e=>{typeof window<"u"&&e!=null&&e!=-1&&_.set(A(e))});let E=h(null);E.subscribe(e=>{typeof window<"u"&&e!=null&&(localStorage[p]=JSON.stringify(e))});var b;typeof window<"u"&&E.set(JSON.parse((b=localStorage[p])!=null?b:"[]"));var O=(e=>(e.Closed="closed",e.Opened="opened",e.Flagged="flagged",e))(O||{}),m=(e=>(e.Empty="empty",e.Mine="mine",e))(m||{}),x=(e=>(e.Playing="playing",e.Won="won",e.Lost="lost",e))(x||{});function P({width:e,height:t,numMines:o}){let s=Array(e*t);for(let l=0;l<e;l++)for(let n=0;n<t;n++){const r=n*e+l;s[r]={state:"closed",numNeighborMines:0,type:"empty"}}return s}var R,V,L;class u{}R=8,V=12,L=16,a(u,R,{width:8,height:8,numMines:10}),a(u,V,{width:12,height:12,numMines:20}),a(u,L,{width:16,height:16,numMines:40});const Y=e=>{const o={board:P(e),...e,firstMove:!0,state:"playing",lostToCell:-1,title:"Save Game "};for(let n=0;n<e.numMines;n++)W(o);J(o);let s=localStorage[p],l;for(let n=0;;n++)if(s.indexOf(n)===-1){l=n;break}o.title+=l,w(l,o),c.set(-1),c.set(l),E.update(n=>{var r;return(r=n==null?void 0:n.push)==null||r.call(n,l),n})},W=e=>{const t=[];for(let s=0;s<e.width*e.height;s++)e.board[s].type==="empty"&&t.push(s);const o=t[I(0,t.length)];e.board[o].type="mine"},J=e=>{for(let t=0;t<(e==null?void 0:e.width);t++)for(let o=0;o<(e==null?void 0:e.height);o++){let s=0;for(let n=0;n<9;n++){const r=Math.floor(n/3)-1,g=n%3-1,d=t+r,f=o+g;if(d<0||d>=e.width||f<0||f>=e.height)continue;const y=f*e.width+d;e.board[y].type==="mine"&&(s+=1)}const l=o*e.width+t;e.board[l].numNeighborMines=s}};i.disable_scroll_handling;const j=i.goto;i.invalidate;i.invalidateAll;i.prefetch;i.prefetch_routes;i.before_navigate;i.after_navigate;export{u as B,m as C,x as G,M,O as a,_ as b,c,G as d,j as g,A as l,Y as n,J as r,W as s,E as u,X as v};
