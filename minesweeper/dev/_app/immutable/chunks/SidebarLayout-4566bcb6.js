var ue=Object.defineProperty;var _e=(e,t,s)=>t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var L=(e,t,s)=>(_e(e,typeof t!="symbol"?t+"":t,s),s);import{w as V,d as S}from"./singletons-f7e93100.js";import{P as le,S as oe,i as ae,s as ie,k as E,l as b,m as N,h as w,n as d,b as re,A as Y,o as ge,Q as pe,B as Q,q as P,a as I,r as T,c as O,G as h,D as K,E as U,F as Z,f as z,t as $}from"./index-2c492789.js";function me(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}const ce="MINESWEEPER_SAVE_SLOTS",B="MINESWEEPER_SAVE_GAME",we=e=>{let t=localStorage[B+`_${e}`];return t?JSON.parse(t):null},he=(e,t)=>{de(e),localStorage[B+`_${e}`]=JSON.stringify(t)},de=e=>{localStorage.removeItem(B+`_${e}`)},ee="v0.2.0";let J=V(null);J.subscribe(e=>{if(typeof window<"u"&&e!=null){let t=le(k);he(t,e)}});let k=V(-1);k.subscribe(e=>{typeof window<"u"&&e!=null&&e!=-1&&J.set(we(e))});let R=V(null);R.subscribe(e=>{typeof window<"u"&&e!=null&&(localStorage[ce]=JSON.stringify(e))});var ne;typeof window<"u"&&R.set(JSON.parse((ne=localStorage[ce])!=null?ne:"[]"));var x=(e=>(e.Closed="closed",e.Opened="opened",e.Flagged="flagged",e))(x||{}),fe=(e=>(e.Empty="empty",e.Mine="mine",e))(fe||{}),ye=(e=>(e.Playing="playing",e.Won="won",e.Lost="lost",e))(ye||{}),Ie,Oe,Re;class W{}Ie=8,Oe=12,Re=16,L(W,Ie,{width:8,height:8,numMines:10}),L(W,Oe,{width:12,height:12,numMines:20}),L(W,Re,{width:16,height:16,numMines:40});const He=e=>{const t=Array(e.width*e.height);for(let n=0;n<e.height*e.width;n++)t[n]={state:"closed",numNeighborMines:0,type:"empty"};const s={board:t,...e,firstMove:!0,state:"playing",lostToCell:-1,title:"Save Game "};for(let n=0;n<e.numMines;n++)Me(s);return Ee(s),s},Me=e=>{const t=[];for(let n=0;n<e.width*e.height;n++)e.board[n].type==="empty"&&t.push(n);const s=t[me(0,t.length)];e.board[s].type="mine"},Ee=e=>{for(let t=0;t<(e==null?void 0:e.width);t++)for(let s=0;s<(e==null?void 0:e.height);s++){let n=0;for(let o=0;o<9;o++){const a=Math.floor(o/3)-1,c=o%3-1,p=t+a,r=s+c;if(p<0||p>=e.width||r<0||r>=e.height)continue;const m=r*e.width+p;e.board[m].type==="mine"&&(n+=1)}const l=s*e.width+t;e.board[l].numNeighborMines=n}};S.disable_scroll_handling;const Ce=S.goto;S.invalidate;S.invalidateAll;S.prefetch;S.prefetch_routes;S.before_navigate;S.after_navigate;const Fe=e=>{R.update(t=>(t.splice(t.indexOf(e),1),t)),de(e)},Pe=e=>{let t=le(R),s;for(let n=0;;n++)if(t.indexOf(n)===-1){s=n;break}e.title+=s,he(s,e),k.set(-1),k.set(s),R.update(n=>{var l;return(l=n==null?void 0:n.push)==null||l.call(n,s),n}),J.set(e)};function be(e){let t,s,n;return{c(){t=E("canvas"),this.h()},l(l){t=b(l,"CANVAS",{width:!0,height:!0,class:!0}),N(t).forEach(w),this.h()},h(){d(t,"width",s=e[0].width+"px"),d(t,"height",n=e[0].height+"px"),d(t,"class","svelte-jhkqpr")},m(l,o){re(l,t,o),e[4](t)},p(l,[o]){o&1&&s!==(s=l[0].width+"px")&&d(t,"width",s),o&1&&n!==(n=l[0].height+"px")&&d(t,"height",n)},i:Y,o:Y,d(l){l&&w(t),e[4](null)}}}function Se(e,t,s){let{showMines:n=!1}=t,{game:l}=t,o,a;ge(()=>{s(3,a=o.getContext("2d")),s(3,a.imageSmoothingEnabled=!1,a),a.fillRect(0,0,o.width,o.height)});const c={mine:"red",closed:"navy",empty:"blue",flag:"gold",clickedMine:"magenta"};function p(r){pe[r?"unshift":"push"](()=>{o=r,s(1,o)})}return e.$$set=r=>{"showMines"in r&&s(2,n=r.showMines),"game"in r&&s(0,l=r.game)},e.$$.update=()=>{if(e.$$.dirty&15&&a){const r=o.width/l.width,m=o.height/l.height;for(let g=0;g<l.width*l.height;g++){const v=l.board[g],G=g%l.width,y=Math.floor(g/l.height);v.state===x.Closed?s(3,a.fillStyle=c.closed,a):g===l.lostToCell&&n?s(3,a.fillStyle=c.clickedMine,a):v.type===fe.Mine&&n?s(3,a.fillStyle=c.mine,a):v.state===x.Flagged?s(3,a.fillStyle=c.flag,a):s(3,a.fillStyle=c.empty,a),a.fillRect(G*r,y*m,r,m)}}},[l,o,n,a,p]}class Te extends oe{constructor(t){super(),ae(this,t,Se,be,ie,{showMines:2,game:0})}}const ve=e=>({}),te=e=>({class:"content"}),Ne=e=>({}),se=e=>({});function Ae(e){let t,s,n,l,o,a,c,p,r,m,g,v,G,y,H,M;const C=e[1].sidebar,f=Q(C,e,e[0],se),F=e[1].content,u=Q(F,e,e[0],te);return{c(){t=E("main"),s=E("aside"),n=E("header"),l=E("h1"),o=P("MineSweeper"),a=I(),c=E("h3"),p=P("By SFG and TMH"),r=I(),m=E("hr"),g=I(),f&&f.c(),v=I(),u&&u.c(),G=I(),y=E("footer"),H=P(ee),this.h()},l(i){t=b(i,"MAIN",{class:!0});var _=N(t);s=b(_,"ASIDE",{class:!0});var A=N(s);n=b(A,"HEADER",{class:!0});var j=N(n);l=b(j,"H1",{id:!0,class:!0});var q=N(l);o=T(q,"MineSweeper"),q.forEach(w),a=O(j),c=b(j,"H3",{id:!0,class:!0});var D=N(c);p=T(D,"By SFG and TMH"),D.forEach(w),j.forEach(w),r=O(A),m=b(A,"HR",{class:!0}),g=O(A),f&&f.l(A),A.forEach(w),v=O(_),u&&u.l(_),G=O(_),y=b(_,"FOOTER",{class:!0});var X=N(y);H=T(X,ee),X.forEach(w),_.forEach(w),this.h()},h(){d(l,"id","title"),d(l,"class","svelte-1oaj3m2"),d(c,"id","creator"),d(c,"class","svelte-1oaj3m2"),d(n,"class","svelte-1oaj3m2"),d(m,"class","svelte-1oaj3m2"),d(s,"class","sidebar svelte-1oaj3m2"),d(y,"class","version svelte-1oaj3m2"),d(t,"class","wrapper svelte-1oaj3m2")},m(i,_){re(i,t,_),h(t,s),h(s,n),h(n,l),h(l,o),h(n,a),h(n,c),h(c,p),h(s,r),h(s,m),h(s,g),f&&f.m(s,null),h(t,v),u&&u.m(t,null),h(t,G),h(t,y),h(y,H),M=!0},p(i,[_]){f&&f.p&&(!M||_&1)&&K(f,C,i,i[0],M?Z(C,i[0],_,Ne):U(i[0]),se),u&&u.p&&(!M||_&1)&&K(u,F,i,i[0],M?Z(F,i[0],_,ve):U(i[0]),te)},i(i){M||(z(f,i),z(u,i),M=!0)},o(i){$(f,i),$(u,i),M=!1},d(i){i&&w(t),f&&f.d(i),u&&u.d(i)}}}function Ge(e,t,s){let{$$slots:n={},$$scope:l}=t;return e.$$set=o=>{"$$scope"in o&&s(0,l=o.$$scope)},[l,n]}class We extends oe{constructor(t){super(),ae(this,t,Ge,Ae,ie,{})}}export{W as B,x as C,ye as G,Te as M,We as S,Pe as a,fe as b,k as c,Fe as d,J as e,Ce as g,we as l,He as n,Ee as r,Me as s,R as u};
