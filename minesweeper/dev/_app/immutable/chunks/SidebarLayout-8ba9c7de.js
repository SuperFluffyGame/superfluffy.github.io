var Ee=Object.defineProperty;var ke=(e,t,s)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var T=(e,t,s)=>(ke(e,typeof t!="symbol"?t+"":t,s),s);import{T as be,S as j,i as K,s as Z,k as w,l as S,m as k,h as M,n as u,b as V,A as U,o as Ie,M as Ne,U as Ae,V as X,a as C,c as G,W as ne,p as A,X as ie,G as _,J as ye,Y as Ce,f as O,g as Ge,t as H,d as Oe,Z as ae,K as Re,_ as Le,$ as oe,B as re,q as J,r as q,D as ce,E as fe,F as he}from"./index-35a657ee.js";import{d as I,w as Q,c as Te}from"./singletons-c694b127.js";function He(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}function st(e){const t=Math.floor(e/3600),s=Math.floor(e/60)%60,l=e%60;let n="";return t>0&&(n+=t.toString().padStart(2,"0")+":"),n+=s.toString().padStart(2,"0")+":",n+=l.toString().padStart(2,"0"),n}var Y=(e=>(e.Closed="closed",e.Opened="opened",e.Flagged="flagged",e))(Y||{}),Me=(e=>(e.Empty="empty",e.Mine="mine",e))(Me||{}),Pe=(e=>(e.Playing="playing",e.Won="won",e.Lost="lost",e))(Pe||{}),Ze,Qe,ze;class D{}Ze=8,Qe=12,ze=16,T(D,Ze,{width:8,height:8,numMines:10}),T(D,Qe,{width:12,height:12,numMines:20}),T(D,ze,{width:16,height:16,numMines:40});const lt=e=>{const t=Array(e.width*e.height);for(let l=0;l<e.height*e.width;l++)t[l]={state:"closed",numNeighborMines:0,type:"empty"};const s={board:t,...e,firstMove:!0,state:"playing",lostToCell:-1,title:"Save Game ",stats:{timePlayed:0}};for(let l=0;l<e.numMines;l++)Ve(s);return We(s),s},Ve=(e,t=[])=>{const s=[];for(let n=0;n<e.width*e.height;n++)e.board[n].type==="empty"&&t.indexOf(n)===-1&&s.push(n);const l=s[He(0,s.length)];e.board[l].type="mine"},We=e=>{for(let t=0;t<(e==null?void 0:e.width);t++)for(let s=0;s<(e==null?void 0:e.height);s++){let l=0;for(let i=0;i<9;i++){const c=Math.floor(i/3)-1,a=i%3-1,y=t+c,f=s+a;if(y<0||y>=e.width||f<0||f>=e.height)continue;const g=f*e.width+y;e.board[g].type==="mine"&&(l+=1)}const n=s*e.width+t;e.board[n].numNeighborMines=l}};I.disable_scroll_handling;const Fe=I.goto;I.invalidate;I.invalidateAll;I.prefetch;I.prefetch_routes;I.before_navigate;I.after_navigate;const we="MINESWEEPER_SAVE_SLOTS",z="MINESWEEPER_SAVE_GAME",xe=e=>{let t=localStorage[z+`_${e}`];return t?JSON.parse(t):null},Se=(e,t)=>{ve(e),localStorage[z+`_${e}`]=JSON.stringify(t)},ve=e=>{localStorage.removeItem(z+`_${e}`)},de="v0.2.0";let $=Q(null);$.subscribe(e=>{if(typeof window<"u"&&e!=null){let t=be(P);Se(t,e)}});let P=Q(-1);P.subscribe(e=>{typeof window<"u"&&e!=null&&e!=-1&&$.set(xe(e))});let R=Q(null);R.subscribe(e=>{typeof window<"u"&&e!=null&&(localStorage[we]=JSON.stringify(e.map(t=>t.index)))});var pe;typeof window<"u"&&R.set(JSON.parse((pe=localStorage[we])!=null?pe:"[]").map(e=>({index:e,selected:!1})));const nt=e=>{R.update(t=>(t.splice(t.findIndex(s=>s.index===e),1),t)),ve(e)},it=e=>{let t=be(R),s;for(let l=0;;l++)if(t.findIndex(n=>n.index===l)===-1){s=l;break}e.title+=s,Se(s,e),P.set(-1),P.set(s),R.update(l=>{var n;return(n=l==null?void 0:l.push)==null||n.call(l,{index:s,selected:!1}),l}),$.set(e)};function Be(e){let t,s,l;return{c(){t=w("canvas"),this.h()},l(n){t=S(n,"CANVAS",{width:!0,height:!0,class:!0}),k(t).forEach(M),this.h()},h(){u(t,"width",s=e[0].width+"px"),u(t,"height",l=e[0].height+"px"),u(t,"class","svelte-jhkqpr")},m(n,i){V(n,t,i),e[4](t)},p(n,[i]){i&1&&s!==(s=n[0].width+"px")&&u(t,"width",s),i&1&&l!==(l=n[0].height+"px")&&u(t,"height",l)},i:U,o:U,d(n){n&&M(t),e[4](null)}}}function Je(e,t,s){let{showMines:l=!1}=t,{game:n}=t;const i={mine:"red",closed:"navy",empty:"blue",flag:"gold",clickedMine:"violet"};let c,a;Ie(()=>{s(3,a=c.getContext("2d")),s(3,a.imageSmoothingEnabled=!1,a),a.clearRect(0,0,c.width,c.height)});function y(f){Ne[f?"unshift":"push"](()=>{c=f,s(1,c)})}return e.$$set=f=>{"showMines"in f&&s(2,l=f.showMines),"game"in f&&s(0,n=f.game)},e.$$.update=()=>{if(e.$$.dirty&15&&a){const f=c.width/n.width,g=c.height/n.height;for(let o=0;o<n.width*n.height;o++){const r=n.board[o],d=o%n.width,v=Math.floor(o/n.height);o===n.lostToCell&&l?s(3,a.fillStyle=i.clickedMine,a):r.state===Y.Closed?s(3,a.fillStyle=i.closed,a):r.type===Me.Mine&&l?s(3,a.fillStyle=i.mine,a):r.state===Y.Flagged?s(3,a.fillStyle=i.flag,a):s(3,a.fillStyle=i.empty,a),a.fillRect(d*f,v*g,f,g)}}},[n,c,l,a,y]}class at extends j{constructor(t){super(),K(this,t,Je,Be,Z,{showMines:2,game:0})}}function ue(e,{delay:t=0,duration:s=400,easing:l=Ae}={}){const n=+getComputedStyle(e).opacity;return{delay:t,duration:s,easing:l,css:i=>`opacity: ${i*n}`}}const qe=""+new URL("../assets/check-ce7a5ec0.svg",import.meta.url).href;function _e(e){let t,s,l,n;return{c(){t=w("img"),this.h()},l(i){t=S(i,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Re(t.src,s=qe)||u(t,"src",s),u(t,"alt",""),u(t,"class","svelte-143f2yf")},m(i,c){V(i,t,c),n=!0},p:U,i(i){n||(Le(()=>{l||(l=oe(t,ue,{duration:50},!0)),l.run(1)}),n=!0)},o(i){l||(l=oe(t,ue,{duration:50},!1)),l.run(0),n=!1},d(i){i&&M(t),i&&l&&l.end()}}}function De(e){let t,s,l,n=`${e[2]}rem`,i=`${e[2]}rem`,c,a,y,f=[{type:"checkbox"},e[3]],g={};for(let r=0;r<f.length;r+=1)g=X(g,f[r]);let o=e[0]&&_e();return{c(){t=w("div"),s=w("input"),l=C(),o&&o.c(),this.h()},l(r){t=S(r,"DIV",{class:!0});var d=k(t);s=S(d,"INPUT",{type:!0}),l=G(d),o&&o.l(d),d.forEach(M),this.h()},h(){ne(s,g),A(s,"border-color",e[1],!1),ie(s,"svelte-143f2yf",!0),u(t,"class","wrapper svelte-143f2yf"),A(t,"width",n,!1),A(t,"height",i,!1)},m(r,d){V(r,t,d),_(t,s),s.autofocus&&s.focus(),s.checked=e[0],_(t,l),o&&o.m(t,null),c=!0,a||(y=ye(s,"change",e[4]),a=!0)},p(r,[d]){ne(s,g=Ce(f,[{type:"checkbox"},d&8&&r[3]])),d&1&&(s.checked=r[0]),A(s,"border-color",r[1],!1),ie(s,"svelte-143f2yf",!0),r[0]?o?(o.p(r,d),d&1&&O(o,1)):(o=_e(),o.c(),O(o,1),o.m(t,null)):o&&(Ge(),H(o,1,1,()=>{o=null}),Oe()),d&4&&n!==(n=`${r[2]}rem`)&&A(t,"width",n,!1),d&4&&i!==(i=`${r[2]}rem`)&&A(t,"height",i,!1)},i(r){c||(O(o),c=!0)},o(r){H(o),c=!1},d(r){r&&M(t),o&&o.d(),a=!1,y()}}}function Ue(e,t,s){let{checked:l}=t,{borderColor:n="black"}=t,{size:i=1.5}=t;function c(){l=this.checked,s(0,l)}return e.$$set=a=>{s(3,t=X(X({},t),ae(a))),"checked"in a&&s(0,l=a.checked),"borderColor"in a&&s(1,n=a.borderColor),"size"in a&&s(2,i=a.size)},t=ae(t),[l,n,i,t,c]}class ot extends j{constructor(t){super(),K(this,t,Ue,De,Z,{checked:0,borderColor:1,size:2})}}const Xe=e=>({}),ge=e=>({class:"content"}),Ye=e=>({}),me=e=>({});function je(e){let t,s,l,n,i,c,a,y,f,g,o,r,d,v,W,E,F,ee;const x=e[2].sidebar,m=re(x,e,e[1],me),B=e[2].content,p=re(B,e,e[1],ge);return{c(){t=w("main"),s=w("aside"),l=w("header"),n=w("h1"),i=J("MineSweeper"),c=C(),a=w("h3"),y=J("By SFG and TMH"),f=C(),g=w("hr"),o=C(),m&&m.c(),r=C(),p&&p.c(),d=C(),v=w("footer"),W=J(de),this.h()},l(h){t=S(h,"MAIN",{class:!0});var b=k(t);s=S(b,"ASIDE",{class:!0});var N=k(s);l=S(N,"HEADER",{class:!0});var L=k(l);n=S(L,"H1",{id:!0,class:!0});var te=k(n);i=q(te,"MineSweeper"),te.forEach(M),c=G(L),a=S(L,"H3",{id:!0,class:!0});var se=k(a);y=q(se,"By SFG and TMH"),se.forEach(M),L.forEach(M),f=G(N),g=S(N,"HR",{class:!0}),o=G(N),m&&m.l(N),N.forEach(M),r=G(b),p&&p.l(b),d=G(b),v=S(b,"FOOTER",{class:!0});var le=k(v);W=q(le,de),le.forEach(M),b.forEach(M),this.h()},h(){u(n,"id","title"),u(n,"class","svelte-18eget0"),u(a,"id","creator"),u(a,"class","svelte-18eget0"),u(l,"class","svelte-18eget0"),u(g,"class","svelte-18eget0"),u(s,"class","sidebar svelte-18eget0"),u(v,"class","version svelte-18eget0"),u(t,"class","wrapper svelte-18eget0")},m(h,b){V(h,t,b),_(t,s),_(s,l),_(l,n),_(n,i),_(l,c),_(l,a),_(a,y),_(s,f),_(s,g),_(s,o),m&&m.m(s,null),_(t,r),p&&p.m(t,null),_(t,d),_(t,v),_(v,W),E=!0,F||(ee=ye(l,"click",e[0]),F=!0)},p(h,[b]){m&&m.p&&(!E||b&2)&&ce(m,x,h,h[1],E?he(x,h[1],b,Ye):fe(h[1]),me),p&&p.p&&(!E||b&2)&&ce(p,B,h,h[1],E?he(B,h[1],b,Xe):fe(h[1]),ge)},i(h){E||(O(m,h),O(p,h),E=!0)},o(h){H(m,h),H(p,h),E=!1},d(h){h&&M(t),m&&m.d(h),p&&p.d(h),F=!1,ee()}}}function Ke(e,t,s){let{$$slots:l={},$$scope:n}=t;const i=()=>{Fe(`${Te}`)};return e.$$set=c=>{"$$scope"in c&&s(1,n=c.$$scope)},[i,n,l]}class rt extends j{constructor(t){super(),K(this,t,Ke,je,Z,{})}}export{D as B,ot as C,Pe as G,at as M,rt as S,it as a,Y as b,P as c,nt as d,Me as e,ue as f,Fe as g,$ as h,xe as l,lt as n,We as r,Ve as s,st as t,R as u};
