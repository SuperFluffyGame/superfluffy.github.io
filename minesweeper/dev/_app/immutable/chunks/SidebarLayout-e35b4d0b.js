var Se=Object.defineProperty;var ke=(e,t,s)=>t in e?Se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var T=(e,t,s)=>(ke(e,typeof t!="symbol"?t+"":t,s),s);import{T as ye,S as j,i as K,s as Z,k as M,l as v,m as k,h as w,n as u,b as W,A as U,o as Ie,M as Ne,U as Ae,V as X,a as C,c as G,W as ne,p as A,X as ie,G as _,J as be,Y as Ce,f as O,g as Ge,t as H,d as Oe,Z as ae,K as Re,_ as Le,$ as oe,B as re,q as J,r as q,D as ce,E as he,F as fe}from"./index-18b70ca5.js";import{d as I,w as Q,c as Te}from"./singletons-0556e34e.js";function He(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}var Y=(e=>(e.Closed="closed",e.Opened="opened",e.Flagged="flagged",e))(Y||{}),we=(e=>(e.Empty="empty",e.Mine="mine",e))(we||{}),Ve=(e=>(e.Playing="playing",e.Won="won",e.Lost="lost",e))(Ve||{}),Ze,Qe,ze;class D{}Ze=8,Qe=12,ze=16,T(D,Ze,{width:8,height:8,numMines:10}),T(D,Qe,{width:12,height:12,numMines:20}),T(D,ze,{width:16,height:16,numMines:40});const st=e=>{const t=Array(e.width*e.height);for(let l=0;l<e.height*e.width;l++)t[l]={state:"closed",numNeighborMines:0,type:"empty"};const s={board:t,...e,firstMove:!0,state:"playing",lostToCell:-1,title:"Save Game "};for(let l=0;l<e.numMines;l++)We(s);return Be(s),s},We=(e,t=[])=>{const s=[];for(let n=0;n<e.width*e.height;n++)e.board[n].type==="empty"&&t.indexOf(n)===-1&&s.push(n);const l=s[He(0,s.length)];e.board[l].type="mine"},Be=e=>{for(let t=0;t<(e==null?void 0:e.width);t++)for(let s=0;s<(e==null?void 0:e.height);s++){let l=0;for(let i=0;i<9;i++){const c=Math.floor(i/3)-1,a=i%3-1,b=t+c,h=s+a;if(b<0||b>=e.width||h<0||h>=e.height)continue;const g=h*e.width+b;e.board[g].type==="mine"&&(l+=1)}const n=s*e.width+t;e.board[n].numNeighborMines=l}};I.disable_scroll_handling;const Fe=I.goto;I.invalidate;I.invalidateAll;I.prefetch;I.prefetch_routes;I.before_navigate;I.after_navigate;const Me="MINESWEEPER_SAVE_SLOTS",z="MINESWEEPER_SAVE_GAME",Pe=e=>{let t=localStorage[z+`_${e}`];return t?JSON.parse(t):null},ve=(e,t)=>{Ee(e),localStorage[z+`_${e}`]=JSON.stringify(t)},Ee=e=>{localStorage.removeItem(z+`_${e}`)},de="v0.2.0";let $=Q(null);$.subscribe(e=>{if(typeof window<"u"&&e!=null){let t=ye(V);ve(t,e)}});let V=Q(-1);V.subscribe(e=>{typeof window<"u"&&e!=null&&e!=-1&&$.set(Pe(e))});let R=Q(null);R.subscribe(e=>{typeof window<"u"&&e!=null&&(localStorage[Me]=JSON.stringify(e.map(t=>t.index)))});var me;typeof window<"u"&&R.set(JSON.parse((me=localStorage[Me])!=null?me:"[]").map(e=>({index:e,selected:!1})));const lt=e=>{R.update(t=>(t.splice(t.findIndex(s=>s.index===e),1),t)),Ee(e)},nt=e=>{let t=ye(R),s;for(let l=0;;l++)if(t.findIndex(n=>n.index===l)===-1){s=l;break}e.title+=s,ve(s,e),V.set(-1),V.set(s),R.update(l=>{var n;return(n=l==null?void 0:l.push)==null||n.call(l,{index:s,selected:!1}),l}),$.set(e)};function xe(e){let t,s,l;return{c(){t=M("canvas"),this.h()},l(n){t=v(n,"CANVAS",{width:!0,height:!0,class:!0}),k(t).forEach(w),this.h()},h(){u(t,"width",s=e[0].width+"px"),u(t,"height",l=e[0].height+"px"),u(t,"class","svelte-jhkqpr")},m(n,i){W(n,t,i),e[4](t)},p(n,[i]){i&1&&s!==(s=n[0].width+"px")&&u(t,"width",s),i&1&&l!==(l=n[0].height+"px")&&u(t,"height",l)},i:U,o:U,d(n){n&&w(t),e[4](null)}}}function Je(e,t,s){let{showMines:l=!1}=t,{game:n}=t;const i={mine:"red",closed:"navy",empty:"blue",flag:"gold",clickedMine:"violet"};let c,a;Ie(()=>{s(3,a=c.getContext("2d")),s(3,a.imageSmoothingEnabled=!1,a),a.clearRect(0,0,c.width,c.height)});function b(h){Ne[h?"unshift":"push"](()=>{c=h,s(1,c)})}return e.$$set=h=>{"showMines"in h&&s(2,l=h.showMines),"game"in h&&s(0,n=h.game)},e.$$.update=()=>{if(e.$$.dirty&15&&a){const h=c.width/n.width,g=c.height/n.height;for(let o=0;o<n.width*n.height;o++){const r=n.board[o],d=o%n.width,E=Math.floor(o/n.height);o===n.lostToCell&&l?s(3,a.fillStyle=i.clickedMine,a):r.state===Y.Closed?s(3,a.fillStyle=i.closed,a):r.type===we.Mine&&l?s(3,a.fillStyle=i.mine,a):r.state===Y.Flagged?s(3,a.fillStyle=i.flag,a):s(3,a.fillStyle=i.empty,a),a.fillRect(d*h,E*g,h,g)}}},[n,c,l,a,b]}class it extends j{constructor(t){super(),K(this,t,Je,xe,Z,{showMines:2,game:0})}}function ue(e,{delay:t=0,duration:s=400,easing:l=Ae}={}){const n=+getComputedStyle(e).opacity;return{delay:t,duration:s,easing:l,css:i=>`opacity: ${i*n}`}}const qe=""+new URL("../assets/check-ce7a5ec0.svg",import.meta.url).href;function _e(e){let t,s,l,n;return{c(){t=M("img"),this.h()},l(i){t=v(i,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Re(t.src,s=qe)||u(t,"src",s),u(t,"alt",""),u(t,"class","svelte-143f2yf")},m(i,c){W(i,t,c),n=!0},p:U,i(i){n||(Le(()=>{l||(l=oe(t,ue,{duration:50},!0)),l.run(1)}),n=!0)},o(i){l||(l=oe(t,ue,{duration:50},!1)),l.run(0),n=!1},d(i){i&&w(t),i&&l&&l.end()}}}function De(e){let t,s,l,n=`${e[2]}rem`,i=`${e[2]}rem`,c,a,b,h=[{type:"checkbox"},e[3]],g={};for(let r=0;r<h.length;r+=1)g=X(g,h[r]);let o=e[0]&&_e();return{c(){t=M("div"),s=M("input"),l=C(),o&&o.c(),this.h()},l(r){t=v(r,"DIV",{class:!0});var d=k(t);s=v(d,"INPUT",{type:!0}),l=G(d),o&&o.l(d),d.forEach(w),this.h()},h(){ne(s,g),A(s,"border-color",e[1],!1),ie(s,"svelte-143f2yf",!0),u(t,"class","wrapper svelte-143f2yf"),A(t,"width",n,!1),A(t,"height",i,!1)},m(r,d){W(r,t,d),_(t,s),s.autofocus&&s.focus(),s.checked=e[0],_(t,l),o&&o.m(t,null),c=!0,a||(b=be(s,"change",e[4]),a=!0)},p(r,[d]){ne(s,g=Ce(h,[{type:"checkbox"},d&8&&r[3]])),d&1&&(s.checked=r[0]),A(s,"border-color",r[1],!1),ie(s,"svelte-143f2yf",!0),r[0]?o?(o.p(r,d),d&1&&O(o,1)):(o=_e(),o.c(),O(o,1),o.m(t,null)):o&&(Ge(),H(o,1,1,()=>{o=null}),Oe()),d&4&&n!==(n=`${r[2]}rem`)&&A(t,"width",n,!1),d&4&&i!==(i=`${r[2]}rem`)&&A(t,"height",i,!1)},i(r){c||(O(o),c=!0)},o(r){H(o),c=!1},d(r){r&&w(t),o&&o.d(),a=!1,b()}}}function Ue(e,t,s){let{checked:l}=t,{borderColor:n="black"}=t,{size:i=1.5}=t;function c(){l=this.checked,s(0,l)}return e.$$set=a=>{s(3,t=X(X({},t),ae(a))),"checked"in a&&s(0,l=a.checked),"borderColor"in a&&s(1,n=a.borderColor),"size"in a&&s(2,i=a.size)},t=ae(t),[l,n,i,t,c]}class at extends j{constructor(t){super(),K(this,t,Ue,De,Z,{checked:0,borderColor:1,size:2})}}const Xe=e=>({}),ge=e=>({class:"content"}),Ye=e=>({}),pe=e=>({});function je(e){let t,s,l,n,i,c,a,b,h,g,o,r,d,E,B,S,F,ee;const P=e[2].sidebar,p=re(P,e,e[1],pe),x=e[2].content,m=re(x,e,e[1],ge);return{c(){t=M("main"),s=M("aside"),l=M("header"),n=M("h1"),i=J("MineSweeper"),c=C(),a=M("h3"),b=J("By SFG and TMH"),h=C(),g=M("hr"),o=C(),p&&p.c(),r=C(),m&&m.c(),d=C(),E=M("footer"),B=J(de),this.h()},l(f){t=v(f,"MAIN",{class:!0});var y=k(t);s=v(y,"ASIDE",{class:!0});var N=k(s);l=v(N,"HEADER",{class:!0});var L=k(l);n=v(L,"H1",{id:!0,class:!0});var te=k(n);i=q(te,"MineSweeper"),te.forEach(w),c=G(L),a=v(L,"H3",{id:!0,class:!0});var se=k(a);b=q(se,"By SFG and TMH"),se.forEach(w),L.forEach(w),h=G(N),g=v(N,"HR",{class:!0}),o=G(N),p&&p.l(N),N.forEach(w),r=G(y),m&&m.l(y),d=G(y),E=v(y,"FOOTER",{class:!0});var le=k(E);B=q(le,de),le.forEach(w),y.forEach(w),this.h()},h(){u(n,"id","title"),u(n,"class","svelte-18eget0"),u(a,"id","creator"),u(a,"class","svelte-18eget0"),u(l,"class","svelte-18eget0"),u(g,"class","svelte-18eget0"),u(s,"class","sidebar svelte-18eget0"),u(E,"class","version svelte-18eget0"),u(t,"class","wrapper svelte-18eget0")},m(f,y){W(f,t,y),_(t,s),_(s,l),_(l,n),_(n,i),_(l,c),_(l,a),_(a,b),_(s,h),_(s,g),_(s,o),p&&p.m(s,null),_(t,r),m&&m.m(t,null),_(t,d),_(t,E),_(E,B),S=!0,F||(ee=be(l,"click",e[0]),F=!0)},p(f,[y]){p&&p.p&&(!S||y&2)&&ce(p,P,f,f[1],S?fe(P,f[1],y,Ye):he(f[1]),pe),m&&m.p&&(!S||y&2)&&ce(m,x,f,f[1],S?fe(x,f[1],y,Xe):he(f[1]),ge)},i(f){S||(O(p,f),O(m,f),S=!0)},o(f){H(p,f),H(m,f),S=!1},d(f){f&&w(t),p&&p.d(f),m&&m.d(f),F=!1,ee()}}}function Ke(e,t,s){let{$$slots:l={},$$scope:n}=t;const i=()=>{Fe(`${Te}`)};return e.$$set=c=>{"$$scope"in c&&s(1,n=c.$$scope)},[i,n,l]}class ot extends j{constructor(t){super(),K(this,t,Ke,je,Z,{})}}export{D as B,at as C,Ve as G,it as M,ot as S,nt as a,Y as b,V as c,lt as d,we as e,ue as f,Fe as g,$ as h,Pe as l,st as n,Be as r,We as s,R as u};
