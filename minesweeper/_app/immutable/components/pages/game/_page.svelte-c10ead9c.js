import{S as V,i as D,s as T,k as $,a as L,l as C,m as E,c as P,h as g,n as N,p as U,b as y,C as b,H as O,K as re,A as B,I as Q,q as v,r as w,J as Z,u as W,g as x,t as F,d as ee,f as Y,G as te,e as X,L as ae,v as le,w as ne,x as se,y as ie,o as ce}from"../../../chunks/index-cf33e6f1.js";import{G as A,C as I,s as fe,r as ue,a as q,n as _e,B as he,g as de}from"../../../chunks/navigation-0f4f683b.js";const oe=(s,e)=>{if(s.state!==A.Playing)return;const l=s.board[e];if(l.state===I.Flagged)return;let n=e%s.width,t=Math.floor(e/s.height);if(l.state=I.Opened,l.isMine&&s.firstMove&&(fe(s),l.isMine=!1,ue(s)),!l.isMine&&l.numNeighborMines===0)for(let i=0;i<9;i++){const r=Math.floor(i/3)-1,a=i%3-1,o=n+r,f=t+a;if(o<0||o>=s.width||f<0||f>=s.height||r===0&&a===0)continue;const d=f*s.width+o;s.board[d].state===I.Closed&&oe(s,d)}l.isMine&&(s.state=A.Lost);let _=!0;for(let i=0;i<s.width*s.height;i++)!s.board[i].isMine&&s.board[i].state!==I.Opened&&(_=!1);_&&(s.state=A.Won),s.firstMove=!1},pe=(s,e)=>{let l=s.board[e];l.state===I.Closed?l.state=I.Flagged:l.state===I.Flagged&&(l.state=I.Closed)};function me(s){let e=(s[0].numNeighborMines===0?"":s[0].numNeighborMines)+"",l;return{c(){l=v(e)},l(n){l=w(n,e)},m(n,t){y(n,l,t)},p(n,t){t&1&&e!==(e=(n[0].numNeighborMines===0?"":n[0].numNeighborMines)+"")&&W(l,e)},d(n){n&&g(l)}}}function be(s){let e;return{c(){e=v("M")},l(l){e=w(l,"M")},m(l,n){y(l,e,n)},p:B,d(l){l&&g(e)}}}function j(s){let e;return{c(){e=v("F")},l(l){e=w(l,"F")},m(l,n){y(l,e,n)},d(l){l&&g(e)}}}function ge(s){var M;let e,l,n,t,_,i=`${((M=s[1])==null?void 0:M.clientWidth)*.75}px`,r,a;function o(m,c){return m[0].isMine?be:me}let f=o(s),d=f(s),u=s[0].state===I.Flagged&&j();return{c(){e=$("div"),d.c(),l=L(),n=$("div"),t=L(),u&&u.c(),this.h()},l(m){e=C(m,"DIV",{class:!0});var c=E(e);d.l(c),l=P(c),n=C(c,"DIV",{class:!0}),E(n).forEach(g),t=P(c),u&&u.l(c),c.forEach(g),this.h()},h(){N(n,"class","cover svelte-2zw0gg"),N(e,"class",_="wrapper "+s[0].state+" svelte-2zw0gg"),U(e,"font-size",i,!1)},m(m,c){y(m,e,c),d.m(e,null),b(e,l),b(e,n),b(e,t),u&&u.m(e,null),s[5](e),r||(a=[O(e,"click",s[2]),O(e,"contextmenu",re(s[3]))],r=!0)},p(m,[c]){var p;f===(f=o(m))&&d?d.p(m,c):(d.d(1),d=f(m),d&&(d.c(),d.m(e,l))),m[0].state===I.Flagged?u||(u=j(),u.c(),u.m(e,null)):u&&(u.d(1),u=null),c&1&&_!==(_="wrapper "+m[0].state+" svelte-2zw0gg")&&N(e,"class",_),c&2&&i!==(i=`${((p=m[1])==null?void 0:p.clientWidth)*.75}px`)&&U(e,"font-size",i,!1)},i:B,o:B,d(m){m&&g(e),d.d(),u&&u.d(),s[5](null),r=!1,Q(a)}}}function ve(s,e,l){let{cell:n}=e,{index:t}=e;const _=o=>{o.button===0&&q.update(f=>(oe(f,t),f))},i=()=>{q.update(o=>(pe(o,t),o))};let r;function a(o){Z[o?"unshift":"push"](()=>{r=o,l(1,r)})}return s.$$set=o=>{"cell"in o&&l(0,n=o.cell),"index"in o&&l(4,t=o.index)},[n,r,_,i,t,a]}class we extends V{constructor(e){super(),D(this,e,ve,ge,T,{cell:0,index:4})}}function J(s,e,l){const n=s.slice();return n[1]=e[l],n[3]=l,n}function Me(s){let e;return{c(){e=v("Loading...")},l(l){e=w(l,"Loading...")},m(l,n){y(l,e,n)},p:B,i:B,o:B,d(l){l&&g(e)}}}function ke(s){let e,l,n=s[0].board,t=[];for(let i=0;i<n.length;i+=1)t[i]=K(J(s,n,i));const _=i=>F(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=X()},l(i){for(let r=0;r<t.length;r+=1)t[r].l(i);e=X()},m(i,r){for(let a=0;a<t.length;a+=1)t[a].m(i,r);y(i,e,r),l=!0},p(i,r){if(r&1){n=i[0].board;let a;for(a=0;a<n.length;a+=1){const o=J(i,n,a);t[a]?(t[a].p(o,r),Y(t[a],1)):(t[a]=K(o),t[a].c(),Y(t[a],1),t[a].m(e.parentNode,e))}for(x(),a=n.length;a<t.length;a+=1)_(a);ee()}},i(i){if(!l){for(let r=0;r<n.length;r+=1)Y(t[r]);l=!0}},o(i){t=t.filter(Boolean);for(let r=0;r<t.length;r+=1)F(t[r]);l=!1},d(i){ae(t,i),i&&g(e)}}}function K(s){let e,l;return e=new we({props:{cell:s[1],index:s[3]}}),{c(){le(e.$$.fragment)},l(n){ne(e.$$.fragment,n)},m(n,t){se(e,n,t),l=!0},p(n,t){const _={};t&1&&(_.cell=n[1]),e.$set(_)},i(n){l||(Y(e.$$.fragment,n),l=!0)},o(n){F(e.$$.fragment,n),l=!1},d(n){ie(e,n)}}}function ye(s){let e,l,n,t,_;const i=[ke,Me],r=[];function a(o,f){return o[0]?0:1}return l=a(s),n=r[l]=i[l](s),{c(){e=$("div"),n.c(),this.h()},l(o){e=C(o,"DIV",{class:!0,style:!0});var f=E(e);n.l(f),f.forEach(g),this.h()},h(){var o,f,d,u;N(e,"class","board svelte-1k2zoje"),N(e,"style",t=`grid-template-columns: repeat(${(f=(o=s[0])==null?void 0:o.width)!=null?f:2}, 1fr); grid-template-rows: repeat(${(u=(d=s[0])==null?void 0:d.height)!=null?u:2}, 1fr);`)},m(o,f){y(o,e,f),r[l].m(e,null),_=!0},p(o,[f]){var u,M,m,c;let d=l;l=a(o),l===d?r[l].p(o,f):(x(),F(r[d],1,1,()=>{r[d]=null}),ee(),n=r[l],n?n.p(o,f):(n=r[l]=i[l](o),n.c()),Y(n,1),n.m(e,null)),(!_||f&1&&t!==(t=`grid-template-columns: repeat(${(M=(u=o[0])==null?void 0:u.width)!=null?M:2}, 1fr); grid-template-rows: repeat(${(c=(m=o[0])==null?void 0:m.height)!=null?c:2}, 1fr);`))&&N(e,"style",t)},i(o){_||(Y(n),_=!0)},o(o){F(n),_=!1},d(o){o&&g(e),r[l].d()}}}function $e(s,e,l){let n;return te(s,q,t=>l(0,n=t)),[n]}class Ce extends V{constructor(e){super(),D(this,e,$e,ye,T,{})}}function Ee(s){let e,l,n,t,_,i=s[1].width+"",r,a,o=s[1].height+"",f,d,u=s[1].numMines+"",M,m;return{c(){e=$("h2"),l=v("You Lost!"),n=L(),t=$("p"),_=v("You lost on a "),r=v(i),a=v("x"),f=v(o),d=v(`\r
                board with `),M=v(u),m=v(" mines.")},l(c){e=C(c,"H2",{});var p=E(e);l=w(p,"You Lost!"),p.forEach(g),n=P(c),t=C(c,"P",{});var h=E(t);_=w(h,"You lost on a "),r=w(h,i),a=w(h,"x"),f=w(h,o),d=w(h,`\r
                board with `),M=w(h,u),m=w(h," mines."),h.forEach(g)},m(c,p){y(c,e,p),b(e,l),y(c,n,p),y(c,t,p),b(t,_),b(t,r),b(t,a),b(t,f),b(t,d),b(t,M),b(t,m)},p(c,p){p&2&&i!==(i=c[1].width+"")&&W(r,i),p&2&&o!==(o=c[1].height+"")&&W(f,o),p&2&&u!==(u=c[1].numMines+"")&&W(M,u)},d(c){c&&g(e),c&&g(n),c&&g(t)}}}function Ne(s){let e,l,n,t,_,i=s[1].width+"",r,a,o=s[1].height+"",f,d,u=s[1].numMines+"",M,m;return{c(){e=$("h2"),l=v("You Won!"),n=L(),t=$("p"),_=v("Congratulations, you won on a "),r=v(i),a=v("x"),f=v(o),d=v(`\r
                board with `),M=v(u),m=v(" mines.")},l(c){e=C(c,"H2",{});var p=E(e);l=w(p,"You Won!"),p.forEach(g),n=P(c),t=C(c,"P",{});var h=E(t);_=w(h,"Congratulations, you won on a "),r=w(h,i),a=w(h,"x"),f=w(h,o),d=w(h,`\r
                board with `),M=w(h,u),m=w(h," mines."),h.forEach(g)},m(c,p){y(c,e,p),b(e,l),y(c,n,p),y(c,t,p),b(t,_),b(t,r),b(t,a),b(t,f),b(t,d),b(t,M),b(t,m)},p(c,p){p&2&&i!==(i=c[1].width+"")&&W(r,i),p&2&&o!==(o=c[1].height+"")&&W(f,o),p&2&&u!==(u=c[1].numMines+"")&&W(M,u)},d(c){c&&g(e),c&&g(n),c&&g(t)}}}function Ie(s){let e,l,n,t,_,i,r,a,o,f,d,u,M,m;l=new Ce({});function c(k,S){var G,z;if(((G=k[1])==null?void 0:G.state)===A.Won)return Ne;if(((z=k[1])==null?void 0:z.state)===A.Lost)return Ee}let p=c(s),h=p&&p(s);return{c(){e=$("main"),le(l.$$.fragment),n=L(),t=$("dialog"),h&&h.c(),_=L(),i=$("div"),r=$("button"),a=v("Back to Menu"),o=L(),f=$("button"),d=v("New Game"),this.h()},l(k){e=C(k,"MAIN",{class:!0});var S=E(e);ne(l.$$.fragment,S),n=P(S),t=C(S,"DIALOG",{class:!0});var G=E(t);h&&h.l(G),_=P(G),i=C(G,"DIV",{class:!0});var z=E(i);r=C(z,"BUTTON",{class:!0});var H=E(r);a=w(H,"Back to Menu"),H.forEach(g),o=P(z),f=C(z,"BUTTON",{class:!0});var R=E(f);d=w(R,"New Game"),R.forEach(g),z.forEach(g),G.forEach(g),S.forEach(g),this.h()},h(){N(r,"class","goto-menu"),N(f,"class","new-game"),N(i,"class","buttons-container"),N(t,"class","aftergame-modal svelte-6viqq6"),N(e,"class","wrapper svelte-6viqq6")},m(k,S){y(k,e,S),se(l,e,null),b(e,n),b(e,t),h&&h.m(t,null),b(t,_),b(t,i),b(i,r),b(r,a),b(i,o),b(i,f),b(f,d),s[4](t),u=!0,M||(m=[O(r,"click",s[3]),O(f,"click",s[2])],M=!0)},p(k,[S]){p===(p=c(k))&&h?h.p(k,S):(h&&h.d(1),h=p&&p(k),h&&(h.c(),h.m(t,_)))},i(k){u||(Y(l.$$.fragment,k),u=!0)},o(k){F(l.$$.fragment,k),u=!1},d(k){k&&g(e),ie(l),h&&h.d(),s[4](null),M=!1,Q(m)}}}function Se(s,e,l){let n;te(s,q,a=>l(1,n=a));let t;q.subscribe(a=>{var o;(a==null?void 0:a.state)!==A.Playing&&((o=t==null?void 0:t.showModal)==null||o.call(t))}),ce(()=>{var a;n.state!==A.Playing&&((a=t==null?void 0:t.showModal)==null||a.call(t))});const _=()=>{_e(he[n.width]),localStorage.removeItem("MINESWEEPER_SAVE_GAME"),t.close()},i=()=>{localStorage.removeItem("MINESWEEPER_SAVE_GAME"),de("/"),t.close()};function r(a){Z[a?"unshift":"push"](()=>{t=a,l(0,t)})}return[t,n,_,i,r]}class Le extends V{constructor(e){super(),D(this,e,Se,Ie,T,{})}}export{Le as default};
